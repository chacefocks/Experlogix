var EXP_STATE_ENABLED=0,EXP_STATE_DISABLED=1,EXP_STATE_HIDDEN=2,EXP_STATE_LOCKED=3,EXP_STATE_CATLOCKED=4,EXP_STATE_CATOPTIONLOCKED=5,EXP_STATE_CATPROPLOCKED=6,EXP_BTNID_SAVE=1,EXP_BTNID_CANCEL=2,EXP_BTNID_RESET=3,EXP_BTNID_QUICKVIEW=4,EXP_BTNID_EXPLAIN=5,EXP_BTNID_FIX=6,EXP_BTNID_PRINT=7,EXP_BTNID_CLOSE=8,EXP_BTNID_ADDLINEITEM=9,EXP_BTNID_SAVEANDCLOSE=10,EXP_BTNID_BACK=11,EXP_BTNID_OK=12,EXP_BTNID_CLOSEKILL=13,EXP_BTNID_INFO=14,EXP_BTNID_SORT=15,EXP_BTNID_BACKLINEITEM=16,EXP_BTNID_COMPARE=17,EXP_BTNID_GLOBALPOPUP=18,EXP_BTNID_SAVEANDCONTINUE=19,EXP_BTNID_BOMVIEW=20,EXP_BTNID_VALIDATE=21,EXP_CATID_LENGTH=3,EXP_OPTID_LENGTH=4,EXP_PROPID_LENGTH=3,EXP_OPTINSTANCEID_LENGTH=3,EXP_PROPERTYPREFIX_LENGTH=2+EXP_PROPID_LENGTH,EXP_PSID,EXP_STYLEDIR,EXP_CSSDIR,EXP_CSSNAME,EXP_CSSURL,EXP_SAVEONERROR,EXP_HIDEINCOMPAT,EXP_ROOT,EXP_CONFIGDIR,EXP_CONFIGURATOR,EXP_BODY,EXP_STATUSBAR,EXP_CATEGORYBAR,EXP_TOOLBAR,EXP_VERSION="",EXP_HIDEGHOSTED,EXP_MODE_QUICKVIEW="",EXP_MODE_OPTPICKER="",EXP_MODE_LISTPICKER="",EXP_MODE_MESSAGE="",EXP_MODE_COMPARE="",EXP_MODE_WEBUPLOADER="",EXP_POS_QUICKVIEW,EXP_POS_QVW="50%",EXP_POS_QVH="70%",EXP_POS_OPTPICKER,EXP_POS_OPW="75%",EXP_POS_OPH="75%",EXP_POS_LISTPICKER,EXP_POS_LPW="75%",EXP_POS_LPH="75%",EXP_POS_MESSAGE,EXP_POS_MSW="50%",EXP_POS_MSH="50%",EXP_POS_COMPARE,EXP_POS_CPW="70%",EXP_POS_CPH="70%",EXP_POS_WEBUPL,EXP_POS_WUW="70%",EXP_POS_WUH="70%",EXP_POS_DEFAULT="top:15px; left:15px; right:15px; bottom:15px;",EXP_AUTODISPLAYPOPUP,EXP_AUTODISPLAYLIST,EXP_AUTOFOCUS,EXP_CONFIGREADONLY,EXP_ISLICENSED,EXP_HASDEFERREDRULES,EXP_FORMATCULTURE,EXP_GLOBALSUPPRESSNAVPROMPT,EXP_SuppressNavPrompt=false,EXP_CancelConfig=false,EXP_ConfigSaved=false,EXP_GT,EXP_DO,EXP_ID_OPTION="O",EXP_ID_NONE="X",EXP_ID_GRID="G",EXP_ID_PROP="P",EXP_ID_CATEGORY="C";function Experlogix_PreSave(){return false}function Experlogix_Saved(){return false}function Experlogix_Cancelled(){return false}function Experlogix_Closed(){return false}function Experlogix_PropertyChangedByUser(){return true}var dom,prevGhostCat,showingMessages=false,savedSaveType,deferredRuleMessages=false,deferredRuleMessagesPending=false,isDeferredRulesResponse=false;function $elem(a){return document.getElementById(a)}var $get=expHttpGet,$post=expHttpPost;function ExpSetInnerValue(a,b){if(a.textContent!=null)a.textContent=b;else a.innerText=b}function ExpGetInnerValue(a){return a.textContent!=null?a.textContent:a.innerText}function ExpInit(){pullBrowserVersion();expResetClientState();expSetKeepAlive();expPreInitClient();ExpLayoutPage(true);expSetFormSubmissionHandler();
//!EXP_ISLICENSED&&expShowLicenseWarning()
}function expResetClientState(){prevGhostCat=null}function expSetFormSubmissionHandler(){if(document.forms.length>0)document.forms[0].onsubmit=function(){return false}}function expFixUpIE7(){if(isIE7)$elem(EXP_CONFIGURATOR).className=$elem(EXP_CONFIGURATOR).className}function isIE8(){return isIE&&browserMajorVersion==8}function isIE9OrLater(){return isIE&&browserMajorVersion>=9}function hasAttrib(b,a){return isIE7?null!=b.getAttribute(a):b.hasAttribute(a)}function getAvailRequestObject(){var a=new HttpSync;a.start();return a}function ExpLayoutPage(b,a){expUpdateSB("",false);loadPageContents(a)}function ExpWindowResize(){resizeComboBoxes()}function ExpBeforeUnloadPage(a){if(EXP_GLOBALSUPPRESSNAVPROMPT)EXP_CancelConfig=true;else{EXP_CancelConfig=false;if(!EXP_SuppressNavPrompt){EXP_CancelConfig=true;if(a&&a!=""){event.returnValue=a;return a}else event.returnValue=!isIE?"":isIE9OrLater()?typeof GEN_WRN_UNLOAD_IE9=="undefined"?"":GEN_WRN_UNLOAD_IE9:GEN_WRN_UNLOAD}}}function ExpUnloadPage(){if(EXP_ConfigSaved){EXP_ConfigSaved=false;return}if(EXP_CancelConfig){var a=EXP_PB.action;a&&EXP_PB.action("CANCELCLOSE",null,null,"GET")}}function ExpAssignUIContent(j,i,h,e,f,g){var b=function(c,b){var a=$elem(c);if(a){a.innerHTML="";if(null!=b)a.innerHTML=b}};b(EXP_BODY,j);b(EXP_CATEGORYBAR,i);b(EXP_TOOLBAR,h);$elem(EXP_BODY).scrollTop=0;EXP_PG.reset();SearchBox.init();if(null!=EXP_DO&&EXP_DO.length>0){for(var c=0,k=EXP_DO.length;c<k;c++){var a=EXP_DO[c];EXP_PG.initOption(a[0],a[1]);EXP_PG.setOptionLockedState(a[0],a[1])}EXP_DO=null}expUpdateSB(e,false);expErrState(f|=false);hideEmptyGridProps();var d=$elem("b21");EXP_HASDEFERREDRULES&&d&&expSetVis(d,EXP_HASDEFERREDRULES);g&&ExpShowMessageDialog(EXP_CONFIGDIR+"/ui/ConfigurationMsg.aspx",DLG_TITLE_MS);setInitialFocus()}function setInitialFocus(){if(!EXP_AUTOFOCUS)return;var a=$($elem(EXP_BODY)).find(":tabbable :first");a&&a.focus()}function expCalendarChanged(a){if(EXP_PB.isProcessingResults())return;var c=a.id,b=a.getISOValue(false);Experlogix_PropertyChangedByUser(c,b)&&EXP_PB.queueChange(c,b)}function expComboBoxChanged(a){if(EXP_PB.isProcessingResults())return;var c=a.id,b=a.getValue();Experlogix_PropertyChangedByUser(c,b)&&EXP_PB.queueChange(c,b)}function expNavTo(e,d){var a=$elem("c"+e);if(d){var b=$elem("c"+d);if(b){expEnsureCatVisible(b);!a&&b.scrollIntoView()}}var c=function(a){var b;if(a.style.display!="none")b=a.scrollHeight;else{a.style.position="absolute";a.style.visibility="hidden";a.style.display="block";b=a.scrollHeight;a.style.position="static";a.style.display="none";a.style.visibility="visible"}return b};prevGhostCat&&a!=prevGhostCat&&EXP_HIDEGHOSTED&&expSlideClosed(prevGhostCat,0,c(prevGhostCat),5,100,function(){a&&a.scrollIntoView();expFixUpIE7()});if(a&&hasAttrib(a,"ghost")){a!=prevGhostCat&&EXP_HIDEGHOSTED&&expSlideOpen(a,0,c(a),5,100,function(){a&&a.scrollIntoView();expFixUpIE7()});a.scrollIntoView();prevGhostCat=a}else if(a){prevGhostCat=null;expEnsureCatVisible(a);a.scrollIntoView()}if(a&&EXP_AUTODISPLAYPOPUP)eval(a.getAttribute("popup"));return false}function ExpHelp(b){var a=expGetCatIdFromHeaderElem(getEventSource(b));ExpShowMessageDialog(EXP_CONFIGDIR+"/ui/ConfigurationMsg.aspx?HelpId="+a,DLG_TITLE_MS);return false}function expTogCat(c){var b=expGetCatIdFromHeaderElem(getEventSource(c)),a=$elem("c"+b);if(null==a.getAttribute("collapsed"))a.setAttribute("collapsed","");else a.removeAttribute("collapsed");a.className=a.className;return false}function expToggleDisplay(a){a.style.display=getStyle(a,"display")?"none":""}function expEnsureCatVisible(a){if(null!=a.getAttribute("collapsed")){a.removeAttribute("collapsed");a.className=a.className}}function expGetCatIdFromHeaderElem(b){var a=b;while("xRgn"!=a.className)a=a.parentNode;return a.id.substr(1)}function ExpStartSave(a){if(!expValReq())return;savedSaveType=a;EXP_PB.action("RUNDEFERREDRULES","OnSave",continueSave)}function continueSave(){var b=$elem("b"+EXP_BTNID_FIX),a=null!=b&&"none"!=getStyle(b,"display");if(EXP_HASDEFERREDRULES){if(deferredRuleMessagesPending)return;if(EXP_SAVEONERROR&&a&&isDeferredRulesResponse&&!deferredRuleMessages&&!confirm(GEN_WRN_ERRORPROMPT))return}if(!EXP_SAVEONERROR)if(a){alert(GEN_WRN_CORRECT);return}expRedirAction(true,savedSaveType);savedSaveType=null}function expRedirAction(a,b,c){if(EXP_PB.isBusy())return;a&&loadTransition("saving");EXP_PB.action(b,c)}function ExpCtlReqPB(){return true}function ExpHide(a){$elem(a).style.display="none"}function ExpShow(b,a){$elem(b).style.display=undefined===a?"":a}function expSetVis(a,b){if(null!=a)a.style.display=b?"":"none"}function expSetCtlState(a,b,c){if(null!=a&&EXP_STATE_HIDDEN!=b){a.checked=c;a.style.display="";a.disabled=b==EXP_STATE_DISABLED||b==EXP_STATE_LOCKED}}function expSetFocus(a){if(!a)return;var b=ExpGetActualControlRef(a);if(!b)return;var c=function(a){try{if(a){a.focus();a.select();a=null}}catch(b){}};setTimeout(function(){c(b)},1)}function expProcessCatBarItems(c){for(var b=0,e=c.length;b<e;++b){var d=c[b],a=$elem("expCL"+d.id);if(a){a.setAttribute("hasSel",d.hasSel==true?1:0);a.className=a.className}}}function expEvalCtrlForFocus(a){if(!a)return null;switch(a.tagName){case"INPUT":case"TEXTAREA":return a;case"DIV":return"xCalendar"==a.className?window[a.id.substr(3)]:"xComboBox"==a.className?window[a.id.substr(5)]:null;default:return null}}function expSetPropState(f,c,d,g,h,e){var b,a=$elem(c);if(null==a){var i=$elem("G"+f);if(null!=i)return}if(null==a){b=c.substr(2+EXP_PROPID_LENGTH);if(EXP_PG.isGridLoaded(b)){alert(GEN_ERR_NOPROP.formatEx({PROPID:c,GRIDID:b,VALUE:d}));return}EXP_PG.loadGrid(b);EXP_PG.setOptionLockedState(f,b);a=$elem(c);if(null==a)return;expSetFlowLayoutProp(a,d,g,h,e)}else if(a.tagName=="TD"){if(!hasAttrib(a.parentNode,"selected")){b=c.substr(2+EXP_PROPID_LENGTH);EXP_PG.loadCatGrid(f,b)}expSetGridLayoutProp(a,d,g,h,e)}else expSetFlowLayoutProp(a,d,g,h,e)}function expSetFlowLayoutProp(a,d,h,l,g){a.style.display=EXP_STATE_HIDDEN==h||"1"==a.getAttribute("hide")?"none":"";if(EXP_STATE_HIDDEN==h)d="";var c,b,j=a.getAttribute("m");switch(j){case undefined:case null:case"0":c=0;b=1;break;case"1":c=1;b=0;break;case"2":c=0;b=0;break;default:return}var m=a.children[c],i=a.children[b];m.className=l?"err":"";var e=i.children,f=e.length,k="2"==j&&f>1?expWalkChildControlsForUpdate(e,g,d):f==1?expUpdateCtl(e[0],g,d):false;if(!k)i.innerHTML=d}function expSetGridLayoutProp(a,c,f,g,d){var b=a.childNodes,e=b.length>0&&expUpdateCtl(b[0],d,c);if(!e)a.innerHTML=c;if(g)a.setAttribute("err","");else a.removeAttribute("err");if(EXP_STATE_HIDDEN==f)a.setAttribute("hide","");else a.removeAttribute("hide");a.className=a.className}function expWalkChildControlsForUpdate(c,d,e){for(var a=false,b=0,f=c.length;b<f;b++){a=expUpdateCtl(c[b],d,e);if(a)break}return a}function expUpdateCtl(a,c,b){var d=a.tagName;if(d=="INPUT"){switch(a.type){case"checkbox":case"radio":a.checked=""==b||"0"==b||"False"==b||"false"==b||"FALSE"==b?false:true;expSetCheckState(a);break;case"text":a.value=b;a.setAttribute("value",b);if(isIE)a.defaultValue=b;else a.setAttribute("defaultValue",b);break;default:alert(GEN_ERR_UNEXPCTL.formatEx({CTLTYPE:a.type,PROPID:propId}))}return true}else if(d=="TEXTAREA"){ExpSetInnerValue(a,b);return true}else if(d=="SPAN"){a.innerHTML=b;return true}else if(d=="DIV"){if("xCalendar"==a.className)window[a.id.substr(3)].setValue(b);else if("xComboBox"==a.className){var e=window[a.id.substr(5)];if(c.list=="")e.setList(null,null);else c.list&&e.setList(c.list,c.headers||resolveListHeaders(c.list));e.setValue(b)}else a.parentNode.innerHTML=b;return true}else return false}function resizeComboBoxes(){for(i=0,len=EXP_PG.comboBoxIds.length;i<len;i++){f=window[EXP_PG.comboBoxIds[i]];f&&expIsCtlVisible(f.comboBoxControl)&&f.sizeToParent()}}function resolveListHeaders(b){var a=b.match(/^expList\d+_[^_]+/);return a?window[a[0]+"_Headers"]:null}function ExpLock(a){var b=a.tagName;if(b=="INPUT")switch(a.type){case"checkbox":case"radio":a.disabled=true;break;case"text":a.readOnly=true;break;default:alert(GEN_ERR_UNEXPCTL.formatEx({CTLTYPE:a.type,PROPID:propId}))}else if(b=="TEXTAREA")a.readOnly=true;else a.setLocked(true)}function ExpUnLock(a){var b=a.tagName;if(b=="INPUT")switch(a.type){case"checkbox":case"radio":a.disabled=false;break;case"text":a.readOnly=false;break;default:alert(GEN_ERR_UNEXPCTL.formatEx({CTLTYPE:a.type,PROPID:propId}))}else if(b=="TEXTAREA")a.readOnly=false;else a.setLocked(false)}function expSetRgnState(b,f,l){var a=$elem("c"+b);if(a){var c=null,d=null;if(EXP_STATE_HIDDEN==f){a.setAttribute("hide","1");a.removeAttribute("err");a.removeAttribute("locked")}else if(EXP_STATE_CATLOCKED==f){a.setAttribute("locked","cat");a.removeAttribute("err");a.removeAttribute("hide");c="lock";d="lock"}else if(EXP_STATE_CATOPTIONLOCKED==f){a.setAttribute("locked","opt");a.removeAttribute("err");a.removeAttribute("hide");c="unlock";d="lock"}else if(EXP_STATE_CATPROPLOCKED==f){a.setAttribute("locked","prop");a.removeAttribute("err");a.removeAttribute("hide");c="lock";d="unlock"}else{a.removeAttribute("err");a.removeAttribute("hide");a.removeAttribute("locked");c="unlock";d="unlock"}if(l){a.setAttribute("err","1");a.removeAttribute("hide")}a.className=a.className;expSetCategoryBarOptionState(b,f,l);c&&EXP_PG.setLocked(b,null,"lock"==c);if(d){var e=expGetCategoryOptionIds(b),h="lock"==d,g=e.length,j=0,k=g;if(g>0)if(e[0]==b){j=1;expSetOptionDisabledState("X"+e[0],h)}else if(e[g-1]==b){k=g-1;expSetOptionDisabledState("X"+e[g-1],h)}for(var i=j;i<k;++i)expSetOptionDisabledState("O"+e[i],h)}}else alert("c"+b+" not found")}function expSetOptionDisabledState(c,b){var a=$elem(c);if(a)a.disabled=b}function expErrState(c){var b=c?"":"none",a=$elem("b"+EXP_BTNID_FIX);if(a)a.style.display=b}function expSetCategoryBarOptionState(e,f,a){var b=$elem("expCL"+e);if(b){var d=b.className;b.className=a?"xCbErr":f==EXP_STATE_HIDDEN?"xCbHid":"";if(a|("xCbErr"==d&&!a)){var c=b.parentNode.getAttribute("id");c&&c.length>0&&expUpdCatGrpErrCnt(c.substr(5),a?1:-1)}}}function expUpdCatGrpErrCnt(d,e){var a=$elem("expCGH"+d);if(a){var c=a.getAttribute("barError"),b=c==null?0:parseInt(c);b+=e;if(b<0)b=0;if(b>0)a.setAttribute("barError",""+b);else a.removeAttribute("barError");a.className=a.className}}
function expValReq(){
try{
var g=document.body.getElementsByTagName("INPUT"),h=document.body.getElementsByTagName("TEXTAREA"),c=Array.prototype.slice.call(g);c=c.concat(Array.prototype.slice.call(h));for(var a,b=0,d=c.length;b<d;b++){a=c[b];if(a.hasAttribute("req")&&!a.hasAttribute("disabled")&&expIsCtlVisible(a)){var f=a.getAttribute("dtype"),e=a.value;if(("N"==f||"R"==f)&&0==expRemoveFormat(a)){alert(GEN_MSG_REQZERO);a.focus();a.select();return false}else if(""==e){alert(GEN_MSG_REQBLANK);a.focus();a.select();return false}}}for(b=0,d=EXP_PG.comboBoxIds.length;b<d;b++){a=window[EXP_PG.comboBoxIds[b]];if(a&&a.required&&!a.disabled&&expIsCtlVisible(a.comboBoxControl)){e=a.getValue();if(""==e){alert(GEN_MSG_REQBLANK);a.focus();return false}}}return true
}catch(err) { return true}
}


function expIsCtlVisible(c){var b=function(a){return"none"==a.display||"hidden"==a.visibility};if(b(getStyle(c,null)))return false;var a=c;while(getStyle(a,null)){if(b(getStyle(a,null)))return false;a=a.parentNode}return true}function ExpGetActualControlRef(e){var a=$elem(e);if("P"==e.substring(0,1)){if(null==a)return null;if(a.tagName=="TD"){var i=a;a=expEvalCtrlForFocus(i.children[0])}else{var g=a,d=g.getAttribute("m"),f=g.children[!d||"0"==d?1:0],b=f.children,h=b.length;if("2"==d&&h>1)for(var c=0,j=b.length;c<j;c++){a=expEvalCtrlForFocus(b[c]);if(a)break}else a=expEvalCtrlForFocus(f.children[0])}}return a}function expGetActiveCtlId(){return expGetCtlId(document.activeElement)}function expGetCtlId(b){if(null==b||b.tagName=="HTML")return null;try{var a=b.parentNode,e=a.tagName=="TD"&&(a.className=="xSel"||a.className=="xCtl");if(e)return a.className=="xSel"?b.id:a.id;else{var c=b.id,d=a.getAttribute("ct");return""==c&&("p"==d||"cp"==d)?a.parentNode.id:""==c&&b.className=="xCal"?a.id.substr(3):""==c?null:c}}catch(f){return null}}function expGetOptionCatId(b){var a=b;while(a.getAttribute("catId")==null&&a.tagName!="BODY"&&a.tagName!="HTML")a=a.parentNode;return a!=null?"c"+a.getAttribute("catId"):null}function expGetCategoryOptionIds(c){var b=[],a=$elem("c"+c);if(!a)return b;if("Grid"==a.getAttribute("layout")){var j=function(a){b.push(a.id)};EXP_PG.enumOptions(c,j)}else for(var e=0,i=a.childNodes.length;e<i;++e){var g=expGetInnerTable(a.childNodes[e]);if(g){for(var h=g.getElementsByTagName("div"),f=0,k=h.length,d;f<k;++f){d=h[f];d.getAttribute("catId")==c&&b.push(d.id)}break}}return b}function expGetInnerTable(a){if(a.className=="xInner"&&a.tagName=="TABLE")return a;for(var b=0,d=a.childNodes.length;b<d;++b){var c=expGetInnerTable(a.childNodes[b]);if(c)return c}return null}function getFormat(b){var a=b.getAttribute("fmt");return!a||-1==a?null:expFmt[a]}function expRemoveFormat(a){var b="text"==a.type||"textarea"==a.type?a.value:ExpGetInnerValue(a);if(b==="")return"";var c=a.getAttribute("culture");if(!c)c=EXP_FORMATCULTURE;var d=getFormat(a);if(!d){var e=a.getAttribute("dtype");if("N"==e||"R"==e)return kendo.parseFloat(b,kendo.cultures[c])}else switch(d.type){case"T":switch(d.cat){case"TelephoneNumber":return UnformatPhoneNumber(b)}break;case"N":switch(d.cat){case"Fraction":return UnformatFraction(b);case"TelephoneNumber":return UnformatPhoneNumber(b);default:return kendo.parseFloat(b,kendo.cultures[c])}}return b}function expApplyFormat(d,b){var c=d.getAttribute("culture");if(!c)c=EXP_FORMATCULTURE;if(!c)return b;if(b===""||!b)return b;var a=getFormat(d);if(!a)return b;switch(a.type){case"T":switch(a.cat){case"TelephoneNumber":return FormatPhoneNumber(b,a.alpha,a.sep);case"Custom":switch(a.textCase){case"Upper":return b.toUpperCase();case"Lower":return b.toLowerCase();default:return b}}break;case"N":switch(a.cat){case"Fraction":return FormatFraction(b,a.mode,a.arg,a.notation,a.reduce);case"TelephoneNumber":return FormatPhoneNumber(b,false,a.sep);default:if(a.f)return kendo.toString(b,a.f,kendo.cultures[c])}}return b}function expApplyFormatForSubmit(c,a){var b=getFormat(c);if(!b)return a;if(a===""||!a)return a;switch(b.type){case"T":switch(b.cat){case"TelephoneNumber":return b.sticky?FormatPhoneNumber(a,b.alpha,b.sep):UnformatPhoneNumber(a);case"Custom":switch(b.textCase){case"Upper":return a.toUpperCase();case"Lower":return a.toLowerCase();default:return a}}break;case"N":switch(b.cat){case"TelephoneNumber":return UnformatPhoneNumber(a);default:if(b.p)return kendo.toString(a,b.p,kendo.cultures["en-US"])}}return a}function rf(b){var a=getEventSource(b),c=expRemoveFormat(a);a.value=expApplyFormat(a,c)}function chgKey(a){if(window.event)a=window.event;switch(a.keyCode){case 13:case 32:a.preventDefault?a.preventDefault():(a.returnValue=false);var b=$elem(EXP_ID_OPTION+expGetOptionId(a));b&&b.click()}}function chg(a){var b=getEventSource(a);return chgImpl(b)}function chgImpl(a){tip.clearLast();tip.hide();var b;if(!a)return false;if("checkbox"==a.type){var e=a.id.length>0&&a.id.substring(0,1)==EXP_ID_OPTION;if(!a.checked&&e&&$elem(expGetOptionCatId(a)).getAttribute("confirmOptDeselect")!=null)if(!confirm(GEN_WRN_REMOPT)){event.returnValue=false;a.focus();a.select();return false}}var h=expEvalPromptForChange(a);if(!h){event.returnValue=false;if("checkbox"==a.type)a.checked=!a.checked;else a.value=a.defaultValue;a.focus();a.select();return false}var c=expGetCtlId(a),f=null!=c&&c.substring(0,1)=="P";if("radio"==a.type)b=a.checked;else if("checkbox"==a.type){b=a.checked;expSetCheckState(a)}else if("text"==a.type||"textarea"==a.type){var d=expEvalTextChange(a);if(d.isError){event.returnValue=false;a.select();return false}else b=expApplyFormatForSubmit(a,d.value)}else return false;var g=f?Experlogix_PropertyChangedByUser(c,b):true;g&&EXP_PB.queueChange(c,b);return false}function expEvalTextChange(a){if(!a)a=this;var b=expRemoveFormat(a);if(b===""){var k=a.getAttribute("nullability");if(k)return{value:null,isError:false}}var g=a.getAttribute("dtype");if(g){var c;if("R"==g){var e=a.getAttribute("min"),d=a.getAttribute("max"),h=a.getAttribute("autoFixRange"),i=h!=null&&h=="true";if(i)c=expEvalRange(e,d,b);else c=expChkRange(e,d,b);if(c.err){alert(c.err);b=null}else if(i)b=c.newVal;else if(!c.isInRange){b=null;expSetFocus(expGetCtlId(a));var l=d?e?GEN_MSG_RANGEPROMPT.formatEx({MINVALUE:e,MAXVALUE:d}):GEN_MSG_RANGEPROMPT_LE.formatEx({MAXVALUE:d}):GEN_MSG_RANGEPROMPT_GE.formatEx({MINVALUE:e});alert(l)}}else if("N"==g){c=expEvalNumeric(b);if(c.err){alert(c.err);b=null}else b=c.newVal}}var j=null==b;if(j)a.value=a.defaultValue;else{var f=expApplyFormat(a,b);if(b!=a.value){a.defaultValue=f;a.value=f}else a.defaultValue=f}return{value:b,isError:j}}function expEvalPromptForChange(a){if(!hasAttrib(a,"chgPrompt"))return true;var c="checkbox"==a.type||a.defaultValue,e="checkbox"==a.type?!a.checked:a.defaultValue||"<BLANK>",d="checkbox"==a.type?a.checked:a.value||"<BLANK>";if(c){var b=a.getAttribute("chgPrompt")||":CTL_CHANGEPROMPT";if(b&&b.length>0&&b.substr(0,1)==":")b=window[b.substr(1)];var f=b.formatEx({OLDVALUE:e,NEWVALUE:d});return confirm(f)}else return true}function executeFunctionByName(d,a){for(var e=Array.prototype.slice.call(arguments,2),b=d.split("."),f=b.pop(),c=0;c<b.length;c++)a=a[b[c]];return a[f].apply(a,e)}function expSetCheckState(a){if(a.checked)a.setAttribute("checked","checked");else a.removeAttribute("checked")}function expSelLineItem(a){EXP_PB.action("SELLINEITEM",expEventCtlId(a));return false}function expDelLineItem(a){confirm(GEN_WRN_REMLINEITEM)&&expRedirAction(true,"DELLINEITEM",expEventCtlId(a));return false}function expDupLineItem(a){expRedirAction(true,"DUPLINEITEM",expEventCtlId(a));return false}function expEditDupLineItem(a){expRedirAction(false,"EDITDUPLINEITEM",expEventCtlId(a));return false}function expShowQuickView(b){var a=expEventCtlId(b),c=EXP_CONFIGDIR+"/UI/QuickView.aspx"+(a?"?pbItem="+a:"");return expShowQuickViewImpl(c)}function expShowQuickViewImpl(a){if(!isIE)showOverlayDialog(a,DLG_TITLE_QV,EXP_POS_QUICKVIEW||EXP_POS_DEFAULT);else expShowDialog(a,EXP_MODE_QUICKVIEW,DLG_TITLE_QV,EXP_POS_QUICKVIEW,EXP_POS_QVW,EXP_POS_QVH);return false}function expShowBomView(b){var a=expEventCtlId(b),c=EXP_CONFIGDIR+"/UI/QuickView.aspx"+(a?"?pbItem="+a+"&":"?")+"quickViewType=B";return expShowBomViewImpl(c)}function expShowBomViewImpl(a){if(!isIE)showOverlayDialog(a,DLG_TITLE_BV,EXP_POS_QUICKVIEW||EXP_POS_DEFAULT);else expShowDialog(a,EXP_MODE_QUICKVIEW,DLG_TITLE_BV,EXP_POS_QUICKVIEW,EXP_POS_QVW,EXP_POS_QVH);return false}function expShowCompare(){var a=EXP_CONFIGDIR+"/UI/Compare.aspx";return expShowCompareImpl(a)}function expShowCompareImpl(a){if(!isIE)showOverlayDialog(a,DLG_TITLE_CP,EXP_POS_COMPARE||EXP_POS_DEFAULT);else expShowDialog(a,EXP_MODE_COMPARE,DLG_TITLE_CP,EXP_POS_COMPARE,EXP_POS_CPW,EXP_POS_CPH);return false}function expShowDialog(b,d,c,a,g,f){if("Overlay"==d||!isIE)showOverlayDialog(b,c,a);else{var e=new ExpModalDialog(b,getDialogDimensionString(g,f)+a+"scroll:no;status:no;resizable:yes;help:no;maximize:yes;minimize:no;");e.show()}}function expShowAbout(a){var c=expEventCtlId(a),b=EXP_CONFIGDIR+"/UI/About.aspx";showOverlayDialog(b,DLG_TITLE_AB,"top:20px; left:20px; width:400px; height:250px;");return false}function expShowLicenseWarning(){var a=EXP_CONFIGDIR+"/UI/LicenseWarning.aspx";showOverlayDialog(a,DLG_TITLE_LW,"top:20px; left:20px; width:400px; height:250px;");return false}function expShowPrompt(c,a,b){var d=EXP_CONFIGDIR+"/UI/Prompt.aspx";showOverlayDialog(d,DLG_TITLE_PR,"top:40px; left:40px; width:475px; height:170px;",{msg:c,val:a,fnCallback:b});return false}function getEventSource(a){return this.event!=null?this.event.srcElement:a!=null&&a.target!=null?a.target:a}function expEventCtlId(a){var b=getEventSource(a);return b.id}function expGetOptionId(a){var b=getEventSource(a);return expGetOptionIdFromElement(b)}function expGetOptionIdFromElement(a){if(!a)return null;do if("TD"==a.tagName){var d=a;a=a.parentNode;var b=a.parentNode.parentNode;if("xCatGrid"==b.className)break;else if("xCatGridInner"==b.className){var c=d.cellIndex-1;a=b.childNodes[0].childNodes[c];break}else a=b}else if("xOB"==a.className||"xOBErr"==a.className||"xOBDis"==a.className)break;else a=a.parentNode;while(null!=a&&"HTML"!=a.tagName);return a.id}function expEvalNumeric(a){return!expIsNumeric(a)?{err:GEN_MSG_ENTERNUM}:{newVal:parseFloat(a)}}function expChkRange(c,b,a){try{if(!expIsNumeric(a))return{err:GEN_MSG_ENTERNUM};c=parseFloat(c);b=parseFloat(b);a=parseFloat(a);return!isNaN(c)&&a<c?{isInRange:false}:!isNaN(b)&&a>b?{isInRange:false}:{isInRange:true}}catch(d){return{err:d.message}}}function expEvalRange(c,b,a){try{if(!expIsNumeric(a))return{err:GEN_MSG_ENTERNUM};c=parseFloat(c);b=parseFloat(b);a=parseFloat(a);return!isNaN(c)&&a<c?{newVal:c}:!isNaN(b)&&a>b?{newVal:b}:{newVal:a}}catch(d){return{err:d.message}}}function expIsNumeric(a){var b=parseFloat(a);return!isNaN(b)}function expPreActionSubmit(a){(a=="SAVE"||a=="SAVECLOSE")&&Experlogix_PreSave()}function expPostActionSubmit(b){if(""==b)return;var a;try{a=JSON.parse(b.toString())}catch(d){try{a=eval("("+b.toString()+")")}catch(d){a=null}}if(null==a){var c=expExtractTitle(b);alert(GEN_ERR_INVALIDRES.formatEx({ERROR:c}));ExpLayoutPage(true);return}else expParseActionResult(a)}function expParseActionResult(a){deferredRuleMessages=false;deferredRuleMessagesPending=false;isDeferredRulesResponse=false;if(null==a)return;var c=a.type;if(c=="newPage")ExpLayoutPage(true);else if(c=="message"){alert(a.result.data);expUpdateSB(null,true);if(a.result.isError&&a.result.isFatal){EXP_SuppressNavPrompt=true;window.location.reload(true);return}}else if(c=="action"){var b=a.result;b.data!=null&&expDoAction(b.data);expUpdateSB(null,true)}else if(c=="serverResponse"){isDeferredRulesResponse=a.deferredRules||false;a.cats&&expProcessAffectedCategories(a.cats);expExecuteRules(a.rules);expUpdateSB(a.statusBar,false);expErrState(a.error||false);a.catBar&&expProcessCatBarItems(a.catBar);hideEmptyGridProps(a.rules);resizeComboBoxes();SearchBox.init();if(a.showMsg||false){if(isDeferredRulesResponse)deferredRuleMessages=deferredRuleMessagesPending=true;ExpShowMessageDialog(EXP_CONFIGDIR+"/ui/ConfigurationMsg.aspx",DLG_TITLE_MS)}}else if(c=="error"){var b=a.result,d=null,e=null;if(b!=null){d=null==b.ErrorCode?"Undefined Error":b.ErrorCode;e=null==b.ErrorDescription?"Undefined Error":b.ErrorDescription}else{d=a.errCode||"Undefined Error";e=a.errDesc||"Undefined Error"}alert(GEN_ERR_CANTPROCESS.formatEx({ERRCODE:d,ERRDESC:e}))}else if(c=="none")expUpdateSB();else alert(ERROR_UNEXPECTED_RESPONSE);setCatHdrVis()}function expDoAction(a){tip.eventData.cancelled=true;EXP_SuppressNavPrompt=false;switch(a){case"LAYOUT":ExpLayoutPage(true);break;case"LAYOUTSTEP":ExpLayoutPage(true,"lineitem");break;case"CANCEL":EXP_SuppressNavPrompt=true;!Experlogix_Cancelled()&&location.reload();break;case"SAVE":case"SAVECLOSE":case"SAVECONTINUE":EXP_SuppressNavPrompt=true;if(!Experlogix_Saved(a))if("SAVE"==a){EXP_ConfigSaved=true;location.reload()}else if("SAVECLOSE"==a){expDoAction("CLOSE");var d=document.getElementById("ctl_pb");d.parentNode.innerHTML="<div style='font-family: Tahoma, Arial, sans-serif; font-size: 1.35em; color: rgb(114, 136, 172); '>"+SAVE_SUCCESS_CLOSE+"</div>"}else ExpLayoutPage(true);break;case"SAVEERROR":if(confirm(ERROR_FAIL_SAVE)){EXP_SuppressNavPrompt=true;ExpLayoutPage(true)}else expDoAction("CANCEL");break;case"KILL":EXP_CancelConfig=true;ExpUnloadPage();expDoAction("CLOSE");break;case"CLOSE":EXP_SuppressNavPrompt=true;var b=Experlogix_Closed(),c=expTriggerCloseEventForHost();!b&&!c&&expGetTopWindow().close()}}function hideEmptyGridProps(j){var i,m,f,d=null;if(j){i=getPropRules(j);m=getOptRules(j);f=getRuleCatIds(i,m);d=getPropRulePropIds(i)}else f=getAllGridCatIds();for(var k=0,p=f.length;k<p;++k){var g=f[k],e=$elem("G"+g);if(e){var c=getGridCatHideableProps(e);if(c.length==0)continue;var a;if(d&&d.length>0){a=[];for(var b=0;b<d.length;++b){var l=d[b],o=l.substr(0,3),n=l.substr(4,3);o==g&&arrayContains(c,n)&&a.push(n)}for(var h=[],b=0;b<c.length;++b)!arrayContains(a,c[b])&&h.push(c[b]);if(h.length>0)a=a.concat(h)}else a=c;if(e.getAttribute("orientation")!="vertical")hideEmptyGridColumns(g,e,a);else hideEmptyGridRows(g,e,a)}}}function getGridCatHideableProps(f){var b=[],c=f.getAttribute("canHide");if(c&&c.length>0){var d=c.split(","),e=d.length;b.length=e;for(var a=0;a<e;++a)b[a]=d[a].substr(2,3)}return b}function hideEmptyGridColumns(q,a,d){var j=countPropertyColumns(a),b=getPreviousHiddenColumnList(a,j);if(!a.origColGroup){for(var k=a.children[0],l={cols:[]},f=0,o=k.children.length;f<o;++f)l.cols.push(k.children[f]);a.origColGroup=l}var e;if(d&&d.length>0)for(var h=0,p=d.length;h<p;++h){var n=d[h],c=findPropertyColumnPos(a,n);if(c>=0){e=isEmptyPropertyColumn(a,c);hidePropertyColumn(a,c,e);b[c]=e}}setHiddenColumnList(a,b);for(var i=0,g=0;g<b.length;++g)if(b[g])++i;var m=j-i;updateHorizTable(a,m);rewriteColGroup(a)}function hideEmptyGridRows(n,k,b){for(var a=[],i=k.children[1],f,d=0,j=i.children.length;d<j;++d){var h=i.children[d];if(h.hasAttribute("hasInnerContent")){f=h.children[0].children[0].children[2];a.push(f)}}var g;if(b&&b.length>0)for(var e=0,m=b.length;e<m;++e){var l=b[e],c=findPropertyRowPos(a[0],l);if(c>=0){g=isEmptyPropertyRow(a,c);hidePropertyRow(a,c,g)}}}function getPropRules(c){for(var b=[],a=0,f=c.length;a<f;++a){var d=c[a],e=d.c;e==EXP_ID_PROP&&b.push(d)}return b}function getOptRules(c){for(var b=[],a=0,f=c.length;a<f;++a){var d=c[a],e=d.c;e==EXP_ID_OPTION&&b.push(d)}return b}function getRuleCatIds(b,c){var a=[];addRules(a,b);addRules(a,c);return a}function addRules(b,d){for(var a=0,e=d.length;a<e;++a){var c=d[a].cat;!arrayContains(b,c)&&b.push(c)}}function getPropRulePropIds(d){for(var a=[],b=0,f=d.length;b<f;++b){var e=d[b],c=e.cat+"."+e.t.substr(2,3);!arrayContains(a,c)&&a.push(c)}return a}function arrayContains(b,d){for(var a=0,c=b.length;a<c;++a)if(b[a]==d)return true;return false}function getAllGridCatIds(){var d=[],b=$elem(EXP_BODY).children[0];if(b)for(var c=0,e=b.children.length;c<e;++c){var a=b.children[c];a.className=="xRgn"&&a.getAttribute("layout")=="Grid"&&d.push(a.getAttribute("id").substring(1))}return d}function countPropertyColumns(g){for(var f=0,d=g.children[1],a=null,c=0,h=d.children.length;c<h;++c)if(d.children[c].className=="template")a=d.children[c];if(a&&a.tagName=="TR")for(var e=0,i=a.children.length;e<i;++e){var b=a.children[e];if(b&&(b.tagName=="TH"||b.tagName=="TD")&&!b.hasAttribute("skip"))++f}return f}function getPreviousHiddenColumnList(f,e){for(var b=[],a=0;a<e;++a)b[a]=false;var c=f.getAttribute("hiddenCols");if(c){var d=c.split(",");for(a=0;a<d.length;++a)b[parseInt(d[a])]=true}return b}function setHiddenColumnList(d,c){for(var a="",b=0,e=c.length;b<e;++b)if(c[b]){if(a.length>0)a+=",";a+=b.toString()}d.setAttribute("hiddenCols",a)}function hasRowNumbering(b){var a=getFirstNonSpannerRow(b.children);if(a&&a.tagName=="TR")if(a.children.length>0&&a.children[0].className=="xNum")return true;return false}function findPropertyColumnPos(d,e){var f=d.children[2],a=getFirstNonSpannerRow(f.children);if(a&&a.tagName=="TR")for(var b=0,g=a.children.length;b<g;++b){var c=a.children[b];if(c.tagName=="TD")if(c.hasAttribute("id")&&c.getAttribute("id").substr(2,3)==e)return b}return-1}function findPropertyRowPos(d,g){for(var a=0,i=d.children.length;a<i;++a)for(var e=d.children[a],c=0,h=e.children.length;c<h;++c){var b=e.children[c];if(b&&b.hasAttribute("id")){var f=b.getAttribute("id").substr(2,3);if(f==g)return a;break}}return-1}function isEmptyPropertyColumn(j,i){for(var c=false,b=true,g=j.children[2],e=0,k=g.children.length;e<k;++e){var d=g.children[e];if(d.tagName=="TR"){var a=d.children[i];if(a&&a.tagName=="TD"&&a.className!="xSubCat"&&a.className!="xNum"&&a.className!="xSel"){var h=d.hasAttribute("selected"),f=!h||a.hasAttribute("hide");c=c||f;b=b&&f}}}return c&&b}function isEmptyPropertyRow(f,k){for(var c=false,b=true,e=0,n=f.length;e<n;++e)for(var j=f[e],h=j.children[k],d=0,m=h.children.length;d<m;++d){var a=h.children[d];if(a&&(a.tagName=="TD"&&a.hasAttribute("id"))){var l=a.getAttribute("id").substr(EXP_PROPERTYPREFIX_LENGTH,EXP_OPTID_LENGTH+EXP_OPTINSTANCEID_LENGTH),i=$elem(l).hasAttribute("selected"),g=!i||a.hasAttribute("hide");c=c||g;b=b&&g}}return c&&b}function hidePropertyColumn(b,a,c){var e=b.children[1],d=b.children[2];hideColumnInRows(e.children,a,c,true);hideColumnInRows(d.children,a,c,false)}function updateHorizTable(e,b){var f=e.children[1],a=e.children[2],c=isSelectorVisibleInTbody(a),d=hasRowNumbering(a);updateHorizTableRows(f.children,b,c,d);updateHorizTableRows(a.children,b,c,d)}function rewriteColGroup(b){for(var e=$elem(EXP_BODY).scrollTop,a=b.children[0],c=a.children.length-1;c>=0;--c)a.removeChild(a.children[c]);var f=b.children[2],d=getFirstNonSpannerRow(f.children);d&&outputColElement(b,a,d);if(isIE8()||isIE7)$elem(EXP_BODY).scrollTop=e}function outputColElement(j,a,f){for(var e=isIE&&document.documentMode<9,h=!e&&(isIE&&document.documentMode<11),i=j.origColGroup,g=0,d=0,k=f.children.length;d<k;++d){var c=f.children[d];if("xSel"==c.className&&c.style.display=="none")continue;if(c.style.display!="none"){var b=i.cols[g];if(e)$c(trim(b.outerHTML),a);else if(h)a.appendChild($(b).clone(true)[0]);else a.innerHTML+=trim(b.outerHTML)}g++}}function hideColumnInRows(f,d,i,g){for(var h=i?"none":"",c=0,j=f.length;c<j;++c){var a=f[c],b;if(a.tagName=="TR")if(!isHeaderRow(a)&&!isNoneOptionRow(a)&&a.className!="template"){if(g){var e=a.children[0].className;if(e!="xSel"&&e!="xNum")--d}b=a.children[d];if(b&&(b.tagName=="TD"||b.tagName=="TH"))b.style.display=h}}}function hidePropertyRow(b,c,d){for(var a=0,e=b.length;a<e;++a)b[a].children[c].style.display=d?"none":""}function updateHorizTableRows(f,e,g,h){for(var d=0,j=f.length;d<j;++d){var a=f[d];if(a.tagName!="TR")continue;if(isNoneOptionRow(a))for(var c=0,i=a.children.length;c<i;++c){var b=a.children[c];if(b&&b.className!="xSel"&&b.className!="xNum"){b.setAttribute("colSpan",e);break}}else if(h&&!g)a.children[0].style.display=0==e?"none":""}}function getFirstNonSpannerRow(b){var a=0,c=b.length;while(a<c&&(isHeaderRow(b[a])||isNoneOptionRow(b[a])))++a;return a<c?b[a]:null}function isHeaderRow(a){return a.children.length>0&&(a.children[0].className=="xSubCat"||a.children[0].className=="xTableHdr")}function isNoneOptionRow(a){return a.className!="template"&&a.hasAttribute("id")&&a.getAttribute("id").length==3}function isSelectorVisibleInTbody(c){var b=function(c,b){var a=c.children;return a.length>b-1&&a[b].className=="xSel"&&a[b].style.display!="none"},a=getFirstNonSpannerRow(c.children);return a?b(a,0)||b(a,1):null}function expTriggerCloseEventForHost(){var a=document.getElementById("closeTrigger");if(a){a.click();return true}return false}function expGetTopWindow(){var a=window.self;while(null!=a.parent&&a!=a.parent)a=a.parent;return a}function expExtractTitle(a){var b=/<title>\s*?([\w \t]+)\s*?<\/title>/i;try{return b.exec(a)[1]}catch(c){return ERROR_FAIL_PARSEHTML}}function expUpdateCategoryUI(g){var f=false,c;try{c=JSON.parse(g)}catch(j){c=eval("("+g+")")}for(var d=0,i=c.length;d<i;d++){var b=c[d];EXP_PG.cacheTemplates(b.id);var a=$elem("c"+b.id);if(a){var e=undefined;if(prevGhostCat&&a.id==prevGhostCat.id){f=true;e=a.style.display}var h=hasAttrib(a,"collapsed");ReplaceOuterHTML(a,b.html);a=$elem("c"+b.id);if(h)if(!hasAttrib(a,"ghost")){a.setAttribute("collapsed","");a.className=a.className}if(f&&e)if(hasAttrib(a,"ghost"))a.style.display=e;else prevGhostCat=null}else{alert(GEN_ERR_UPDATECAT.formatEx({CATID:b.id}));return}}EXP_PG.restoreAllTemplates();expFixUpIE7()}function expProcessAffectedCategories(a){expRequestCategoryHtml(a,expUpdateCategoryUI)}function expSortPopupCategories(){expRequestSort(expUpdateCategoryUI)}function expExecuteRules(n){for(var p=expSetPropState,q=expSetRgnState,r=expSetVis,l=expSetCtlState,i=function(a,c,b){if(b==EXP_STATE_HIDDEN||b==EXP_STATE_DISABLED&&EXP_HIDEINCOMPAT)a.setAttribute("hide","");else{a.removeAttribute("hide");if(c){a.setAttribute("error","");a.removeAttribute("excl")}else if(EXP_STATE_DISABLED==b){a.removeAttribute("error");a.setAttribute("excl","")}else{a.removeAttribute("error");a.removeAttribute("excl")}a.className=a.className}},k=0,t=n.length;k<t;++k){var a=n[k],e=a.c,c=a.t;if(e==EXP_ID_OPTION||e==EXP_ID_NONE){var b=$elem(c);if(b){var d=a.s,h=a.err||false,j=!(EXP_STATE_DISABLED==d&&EXP_HIDEINCOMPAT),g,f,s=$elem("G"+a.cat);if(s){g=$elem(e+c);if(j){f=a.sel||false;if(!b.className||b.className!="xGridNone")if(!f)EXP_PG.killCatGrid(a.cat,c);else EXP_PG.loadCatGrid(a.cat,c);l(g,d,f)}if("TR"==b.tagName)i(b,h,d);else if("COL"==b.tagName){i(g.parentNode,h,d);EXP_PG.enumOptionCells(null,c,function(b,a){i(a,h,d)})}}else{r(b,j);if(j){var o=$elem("G"+c);f=a.sel||false;if(null!=o)o.style.display=f?"":"none";g=$elem(e+c);l(g,d,f);if(d==EXP_STATE_HIDDEN)b.style.display="none";else b.className=h?"xOBErr":d==EXP_STATE_DISABLED?"xOBDis":"xOB"}}}}else if(e==EXP_ID_PROP)p(a.cat,c,a.v||"",a.s,a.err||false,{list:a.list||null,headers:a.headers||null});else if(e==EXP_ID_CATEGORY)q(c,a.s,a.err||false);else if(e==EXP_ID_GRID){var m=$elem("G"+a.t);if(m)m.style.display=EXP_STATE_HIDDEN!=a.s?"":"none"}}}function expGetMaxLength(b){var a=-1;if(hasAttrib(b,"maxLength")){var c=b.getAttribute("maxLength");if(/^\d+$/.test(c))a=parseInt(c)}return a}function expMaxLength(b){var a=expGetMaxLength(b);return-1==a||b.value.length<a}function expMaxLengthPaste(b){var a=expGetMaxLength(b);return-1==a||b.value.length+window.clipboardData.getData("Text").length<=a}function expUpdateSB(c,b){try{var a=$elem(EXP_STATUSBAR);if(a){a.innerHTML=null!=c?"<span class='xSbText'>"+c+"</span>":hasAttrib(a,"prev")?a.getAttribute("prev"):"";if(EXP_VERSION!=""&&a.getElementsByClassName("xSbVer").length==0)a.innerHTML+="<span class='xSbVer'>Ver. "+EXP_VERSION+"</span>";b!=="undefined"&&!b&&a.setAttribute("prev",a.innerHTML)}}catch(d){}}function ExpShowMessageDialog(c,a){if(showingMessages)return;showingMessages=true;if(null==a||""==a)a=DLG_TITLE_MS;if("Overlay"==EXP_MODE_MESSAGE||!isIE){var d="background-color:white; "+(EXP_POS_MESSAGE||EXP_POS_DEFAULT);showOverlayDialog(c,a,d,{css:[EXP_STYLEDIR+"Common/Core.css",EXP_CSSURL],fnSaveCallback:messageSaveCallback},function(){showingMessages=false})}else{var b=new ExpModalDialog(c,getDialogDimensionString(EXP_POS_MSW,EXP_POS_MSH)+EXP_POS_MESSAGE+"scroll:no;status:no;resizable:yes;help:no;maximize:yes;minimize:no;");b.setArguments({css:[EXP_STYLEDIR+"Common/Core.css",EXP_CSSURL],fnSaveCallback:messageSaveCallback});b.show();showingMessages=false}}function messageSaveCallback(b,f){for(var c=[],e=[],a=0,g=b.length;a<g;++a){c.push(b[a].substr(1));e.push(b[a].charAt(0)=="+")}var d=function(){};if(f||false){deferredRuleMessagesPending=false;d=continueSave}c.length>0&&EXP_PB.queueChanges(c,e,d)}function expCatGrpHdr(c){var a=$elem("expCGH"+c),b=a.getAttribute("barState")!="open";a.setAttribute("barstate",b?"open":"closed");a.className=a.className;var d=$elem("expCG"+c);d.style.display=b?"":"none";return false}function setCatHdrVis(){var a=$elem(EXP_CATEGORYBAR);if(a!=null&&a.style.display!="none")for(var b=0;b<a.children.length;++b){var c=a.children[b];if(c.tagName=="A"){for(var f=$elem("expCG"+c.id.substring(6)),e=false,d=0;d<f.children.length;++d){var g=f.children[d];if(getStyle(g,"display")!="none"){e=true;break}}c.style.display=e?"":"none"}}}function loadTransition(b){var a=getAvailRequestObject();try{if(a.req){var c=EXP_CONFIGDIR+"/handlers/ClientUI.ashx?"+b;a.req.open("GET",c,false);a.req.onreadystatechange=function(){if(4==a.req.readyState){var b=a.req.responseText;a.done();ExpAssignUIContent(b)}};a.req.send("")}else return null}catch(d){a&&a.done();alert(ERROR_FAIL_TRANSITION+"\n\n"+d.message);return null}}function expPreInitClient(){var a=getAvailRequestObject();try{if(a.req){var c=EXP_CONFIGDIR+"/handlers/ClientUI.ashx?init";a.req.open("POST",c,false);a.req.onreadystatechange=function(){4==a.req.readyState&&a.done()};var e=new Date;var d=new ExpStringBuilder,b=d.toString();a.req.send(b)}else return null}catch(f){a&&a.done();alert(ERROR_FAIL_PREINIT+"\n\n"+f.message);return null}}function expRequestCategoryHtml(c,b){var a=getAvailRequestObject();try{if(a.req){var d=EXP_CONFIGDIR+"/handlers/ClientUI.ashx?getCategoryHtml";a.req.open("POST",d,false);a.req.onreadystatechange=function(){if(4==a.req.readyState){var c=a.req.responseText;a.done();b(c)}};a.req.send(c)}else return null}catch(e){a&&a.done();alert(ERROR_FAIL_CATREQUEST+"\n\n"+e.message);return null}}function expRequestSort(b){var a=getAvailRequestObject();try{if(a.req){var c=EXP_CONFIGDIR+"/handlers/ClientUI.ashx?sort";a.req.open("POST",c,false);a.req.onreadystatechange=function(){if(4==a.req.readyState){var c=a.req.responseText;a.done();b(c)}};a.req.send("")}else return null}catch(d){a&&a.done();alert(ERROR_FAIL_SORT+"\n\n"+d.message);return null}}function loadPageContents(b){var a=getAvailRequestObject();try{if(a.req){EXP_SuppressNavPrompt=false;var c=EXP_CONFIGDIR+"/handlers/ClientUI.ashx";if(b)c+="?step:"+b;a.req.open("GET",c,false);a.req.onreadystatechange=function(){if(4==a.req.readyState)try{var d=a.req.responseText;a.done();if("({"==d.substr(0,2)){var b=eval(d);if(b.InitScripts)eval(b.InitScripts);ExpAssignUIContent(b.BodyContent,b.CategoryBarContent,b.ToolbarContent,b.StatusBarContent,b.ErrorsExist,b.HasMessages)}else{var f=/^\s*<!DOCTYPE/i;if(null!=f.exec(d)){ExpAssignUIContent(null);var c=$c("iframe",$elem(EXP_BODY)||document);c.setAttribute("frameborder","0");c.setAttribute("width","100%");c.setAttribute("height","100%");c.setAttribute("class","err");var e=c.contentWindow.document;e.open();e.writeln(d);e.close()}else ExpAssignUIContent(d)}}catch(g){alert(ERROR_FAIL_LOADPAGE+"\n\n"+g.message)}};a.req.send("")}else return null}catch(d){a&&a.done();alert(ERROR_FAIL_LOADPAGE+"\n\n"+d.message);return null}}function expSetKeepAlive(){setInterval("expKeepAlive()",3e5)}function expKeepAlive(){EXP_PB.action("KEEPALIVE")}function expModelSelectorResponse(a,b){EXP_PB.selectModel(a,b);return false}function expCleanForPostback(b){if(b===null||b===undefined)return"";if(typeof b!="string")return b;for(var a=[],c=0,e=b.length;c<e;c++){var d=b.charAt(c);switch(d){case"&":a.push("&amp;");break;case"<":a.push("&lt;");break;case">":a.push("&gt;");break;case"'":a.push("&apos;");break;case'"':a.push("&quot;");break;default:a.push(d)}}return a.join("")}function expTbClick(d,c,b){var a=true;switch(c){case EXP_BTNID_SAVE:case EXP_BTNID_SAVEANDCLOSE:case EXP_BTNID_SAVEANDCONTINUE:if(b)a=confirm(GEN_WRN_SAVE);if(a)if(EXP_BTNID_SAVE==c){expResetClientState();ExpStartSave("SAVE")}else if(c==EXP_BTNID_SAVEANDCLOSE)ExpStartSave("SAVECLOSE");else ExpStartSave("SAVECONTINUE");break;case EXP_BTNID_BACK:if(b&&!EXP_CONFIGREADONLY)a=confirm(GEN_WRN_BACK);if(a){expResetClientState();EXP_PB.action("BACK")}break;case EXP_BTNID_BACKLINEITEM:if(b&&!EXP_CONFIGREADONLY)a=confirm(GEN_WRN_BACK);if(a){expResetClientState();EXP_PB.action("BACKLINEITEM")}break;case EXP_BTNID_CANCEL:if(b)a=confirm(GEN_WRN_CANCEL);if(a){expResetClientState();EXP_PB.action("CANCEL")}break;case EXP_BTNID_RESET:if(b)a=confirm(GEN_WRN_RESET);if(a){expResetClientState();EXP_PB.action("RESET")}break;case EXP_BTNID_QUICKVIEW:expShowQuickView(d);break;case EXP_BTNID_BOMVIEW:expShowBomView(d);break;case EXP_BTNID_EXPLAIN:if(b)a=true;break;case EXP_BTNID_FIX:if(b)a=confirm(GEN_WRN_FIX);a&&EXP_PB.action("FIX");break;case EXP_BTNID_PRINT:window.print();break;case EXP_BTNID_CLOSE:if(b)a=confirm(GEN_WRN_CLOSE);a&&expDoAction("CLOSE");break;case EXP_BTNID_CLOSEKILL:if(b&&!EXP_CONFIGREADONLY)a=confirm(GEN_WRN_KILL);a&&expDoAction("KILL");break;case EXP_BTNID_ADDLINEITEM:if(b)a=confirm(GEN_WRN_ADDLINEITEM);a&&EXP_PB.action("ADD");break;case EXP_BTNID_OK:getTopWindow().close();break;case EXP_BTNID_INFO:ExpShowMessageDialog(EXP_CONFIGDIR+"/ui/ConfigurationMsg.aspx?HelpId=0",DLG_TITLE_MS);break;case EXP_BTNID_SORT:expSortPopupCategories();break;case EXP_BTNID_COMPARE:expShowCompare();break;case EXP_BTNID_GLOBALPOPUP:expAddOptionPopup(DLG_TITLE_GP,"*");break;case EXP_BTNID_VALIDATE:EXP_PB.action("RUNDEFERREDRULES","UserInitiated");break;default:alert("Unknown button id: "+c)}return false}function expInvokeCategoryPopup(c){var b=$elem("c"+c),a=b.getAttribute("popup");if(a)eval(a);return false}function expResetCategory(b,a){(!a||confirm(GEN_WRN_CLEARCAT))&&EXP_PB.updateConfig("reset","category",b);return false}function selOpt(d){for(var e=expGetOptionId(d),b=["O","S","M","X"],a=0;a<b.length;++a){var c=document.getElementById(b[a]+e);if(c){c.click();return}}}function addOptionDirect(a){if(!a)return false;EXP_PB.queueChange("Z"+a,true);return false}function expAddOptionPopup(a,c,k,l,m,j,n,g,f,h,d){if(c!="*"){var p=$elem("c"+c),e=p.getAttribute("locked");if("cat"==e||"opt"==e){alert(GEN_WRN_CANTADD);return}}var b,o="?type=option&src="+c+(k?"&vr="+k:"")+(l?"&vf="+l:"")+(m?"&vso="+m:"")+(j?"&vpf="+j:"")+(n?"&vsd="+n:"")+(g?"&vspc="+g:"")+(f?"&vsbc="+f:"")+(h?"&aci="+h:"")+(d?"&da="+d:"");if("Overlay"==EXP_MODE_OPTPICKER||!isIE){if(null==a||""==a)a=DLG_TITLE_OP;b=EXP_CONFIGDIR+"/ui/Picker.aspx"+o;showOverlayDialog(b,a,EXP_POS_OPTPICKER||EXP_POS_DEFAULT,{fnSaveCallback:addOptionPopupSaveCallback})}else{b=EXP_CONFIGDIR+"/ui/PickerDialogHost.aspx"+o;var i=new ExpModalDialog(b,getDialogDimensionString(EXP_POS_OPW,EXP_POS_OPH)+EXP_POS_OPTPICKER+"scroll:no;status:no;resizable:yes;help:no;maximize:yes;minimize:no;");i.setArguments({fnSaveCallback:addOptionPopupSaveCallback});i.show()}}function addOptionPopupSaveCallback(e){var a=new ExpStringBuilder;a.append("<options>");var b,c,d;for(var f in e){b=e[f];if(b.isClone){a.append('<clone id="'+b.id+'"');b.cat&&a.append(' catId="'+b.cat+'"');b.count&&a.append(' count="'+b.count+'"');a.append("/>")}else{a.append('<add id="'+b.id+'"');b.cat&&a.append(' catId="'+b.cat+'"');b.count&&a.append(' count="'+b.count+'"');c=b.props;if(c){a.append(">");for(var g in c){d=c[g];a.append('<prop id="'+d.id+'" val="'+expCleanForPostback(d.val)+'"/>')}a.append("</add>")}else a.append("/>")}}a.append("</options>");EXP_PB.raw(a.toString())}function expShowListOptionPicker(a,e){var b,d="?type=runtimeCat&src="+e;if("Overlay"==EXP_MODE_OPTPICKER||!isIE){if(null==a||""==a)a=DLG_TITLE_OP;b=EXP_CONFIGDIR+"/ui/Picker.aspx"+d;showOverlayDialog(b,a,EXP_POS_OPTPICKER||EXP_POS_DEFAULT,{fnSaveCallback:addOptionPopupSaveCallback},function(){})}else{b=EXP_CONFIGDIR+"/ui/PickerDialogHost.aspx"+d;var c=new ExpModalDialog(b,getDialogDimensionString(EXP_POS_OPW,EXP_POS_OPH)+EXP_POS_OPTPICKER+"scroll:no;status:no;resizable:yes;help:no;maximize:yes;minimize:no;");c.setArguments({fnSaveCallback:addOptionPopupSaveCallback});c.show()}}function expListPicker(a){expShowListPicker(null,a.id)}function expShowListPicker(a,d){var b,e="?type=list&src="+d;if("Overlay"==EXP_MODE_LISTPICKER||!isIE){if(null==a||""==a)a=DLG_TITLE_LP;b=EXP_CONFIGDIR+"/ui/Picker.aspx"+e;showOverlayDialog(b,a,EXP_POS_LISTPICKER||EXP_POS_DEFAULT,{fnSaveCallback:listPickerCallback},function(){window[d].focus()})}else{b=EXP_CONFIGDIR+"/ui/PickerDialogHost.aspx"+e;var c=new ExpModalDialog(b,getDialogDimensionString(EXP_POS_LPW,EXP_POS_LPH)+EXP_POS_LISTPICKER+"scroll:no;status:no;resizable:yes;help:no;maximize:yes;minimize:no;");c.setArguments({fnSaveCallback:listPickerCallback});c.show()}}function listPickerCallback(a){var b=window[a.pid];b.setValue(a.value)}function expShowWebUploader(a,d){var c=EXP_CONFIGDIR+"/UI/WebUploader.aspx?catId="+d;if("Overlay"==EXP_MODE_WEBUPLOADER||!isIE){if(null==a||""==a)a=DLG_TITLE_WU;showOverlayDialog(c,a,EXP_POS_WEBUPL||EXP_POS_DEFAULT,{fnSaveCallback:addOptionUploadSaveCallback})}else{var b=new ExpModalDialog(c,getDialogDimensionString(EXP_POS_WUW,EXP_POS_WUH)+EXP_POS_WEBUPL+"scroll:no;status:no;resizable:yes;help:no;maximize:yes;minimize:no;");b.setArguments({fnSaveCallback:addOptionUploadSaveCallback});b.show()}return false}function addOptionUploadSaveCallback(a){if(a&&a.Cancel){var b=EXP_ROOT+"/configurator/handlers/WebUploaderHandler.ashx?clearCache=1";expHttpPost(b,null,"Error clearing cached upload",null,null)}else EXP_PB.raw("<uploadOptions />")}function linkOverlay(a){if(!a||0==a.length)alert("Unable to open link; URL not specified.");else showOverlayDialog(a,"","top:50px; right:50px; bottom:50px; left:50px");return false}function linkModal(a){if(!a||0==a.length)alert("Unable to open link; URL not specified.");else window.showModalDialog(a,null,getDialogDimensionString("70%","70%")+"scroll:yes;status:no;resizable:yes;help:no;center:yes;maximize:yes;minimize:no;");return false}function getDialogDimensionString(b,a){var d=typeof b=="string"&&b.length>0&&b.substr(b.length-1,1)=="%"?screen.availWidth*(parseInt(b)/100):b,c=typeof a=="string"&&a.length>0&&a.substr(a.length-1,1)=="%"?screen.availHeight*(parseInt(a)/100):a;return"dialogWidth:"+parseInt(d)+"px;dialogHeight:"+parseInt(c)+"px;"}function expHttpGet(d,f,b,e){var c=null;if(d){var a=getAvailRequestObject();try{if(a.req){a.req.open("GET",d,false);a.req.onreadystatechange=function(){if(4==a.req.readyState&&b)c=b(a.req,e)};a.req.send("")}}catch(g){alert(f+"\n\n"+g.message)}a&&a.done()}return c}function expHttpPost(d,g,f,b,e){var c=null;if(d){var a=getAvailRequestObject();try{if(a.req){a.req.open("POST",d,false);a.req.onreadystatechange=function(){if(4==a.req.readyState&&b)c=b(a.req,e)};a.req.send(g)}}catch(h){alert(f+"\n\n"+h.message)}a&&a.done()}return c}function attachTo(a,b,c){if(a.attachEvent)a.attachEvent("on"+b,c);else a.addEventListener(b,c,false)}function detachFrom(a,b,c){if(a.detachEvent)a.detachEvent("on"+b,c);else a.removeEventListener(b,c,false)}function InitializeOuterHTML(){var a=null;if(document.body.__defineGetter__)if(HTMLElement){a=HTMLElement.prototype;a.__defineGetter__&&a.__defineGetter__("outerHTML",function(){var a=this.parentNode,b=document.createElement(a.tagName);b.appendChild(this);var c=b.innerHTML;a.appendChild(this);return c})}a&&a.__defineSetter__&&a.__defineSetter__("outerHTML",function(d){var b=document.createElement("div");b.innerHTML=d;var a=document.createRange();a.selectNodeContents(b);var c=a.extractContents();this.parentNode.insertBefore(c,this);this.parentNode.removeChild(this)})}function ReplaceOuterHTML(a,b){!a.outerHTML&&InitializeOuterHTML();a.outerHTML=b}function GetInputSelection(a){var d=0,b=0,h,g,c,e,f;if(typeof a.selectionStart=="number"&&typeof a.selectionEnd=="number"){d=a.selectionStart;b=a.selectionEnd}else{g=document.selection.createRange();if(g&&g.parentElement()==a){e=a.value.length;h=a.value.replace(/\r\n/g,"\n");c=a.createTextRange();c.moveToBookmark(g.getBookmark());f=a.createTextRange();f.collapse(false);if(c.compareEndPoints("StartToEnd",f)>-1)d=b=e;else{d=-c.moveStart("character",-e);d+=h.slice(0,d).split("\n").length-1;if(c.compareEndPoints("EndToEnd",f)>-1)b=e;else{b=-c.moveEnd("character",-e);b+=h.slice(0,b).split("\n").length-1}}}}return{start:d,end:b,len:function(){return this.end-this.start}}}function getStyle(a,b){if(a.currentStyle)return b!=null?a.currentStyle[b]:a.currentStyle;else if(document.defaultView&&document.defaultView.getComputedStyle)try{return b!=null?document.defaultView.getComputedStyle(a,"")[b]:document.defaultView.getComputedStyle(a,"")}catch(c){return null}else return b!=null?a.style[b]:a.style}function trim(a){return a.replace(/^\s+|\s+$/g,"")}function ExpCloneOption(c,b){var a=expGetOptionId(c);return expAddOrClone({id:a,isClone:true},b)}function ExpCloneOptionWithPrompt(d,b,c){var a=expGetOptionId(d);expShowPrompt(c||GEN_MSG_CLONEPROMPT,b||1,function(b){return expAddOrClone({id:a,isClone:true},b)});return false}function ExpAddNewOption(c,b){var a=expGetOptionId(c),d=a.substr(0,EXP_OPTID_LENGTH);return expAddOrClone({id:d},b)}function ExpAddNewOptionWithPrompt(d,b,c){var a=expGetOptionId(d),e=a.substr(0,EXP_OPTID_LENGTH);expShowPrompt(c||GEN_MSG_ADDPROMPT,b||1,function(a){return expAddOrClone({id:e},a)});return false}function expAddOrClone(b,a){a=expGetCount(a);if(isNaN(a)||a<=0)return false;if(a>1)b.count=a;addOptionPopupSaveCallback([b]);return false}function expGetCount(b){if(b===undefined)return 1;var a;try{a=parseInt(b)}catch(c){a=0}return a};