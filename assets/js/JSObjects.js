function ExpSlideDataObj(d,c,b,a){this.Object=null;this.TimerID=null;this.StartTime=0;this.MinHeight=d;this.MaxHeight=c;this.Moving=false;this.Duration=a;this.Interval=b;this.Action="";this.DoneFn=null}var anim=[];function expSlideClosed(b,g,f,e,d,c){var a=b.id,h=getSlideData(a,g,f,e,d,"close",c);if(h.Moving||b.style.display=="none")return;expStartSlide(a)}function expSlideOpen(b,g,f,e,d,c){var a=b.id,h=getSlideData(a,g,f,e,d,"open",c);if(h.Moving||b.style.display!="none")return;expStartSlide(a)}function getSlideData(b,h,g,e,d,f,c){var a=anim[b];if(a)return a;a=new ExpSlideDataObj(h,g,e,d);a.Object=$elem(b);a.Action=f;a.DoneFn=c;anim[b]=a;return a}function expStartSlide(b){var a=anim[b];a.Moving=true;a.StartTime=(new Date).getTime();if("open"==a.Action)a.Object.style.height="1px";a.Object.style.display="block";a.TimerID=setInterval("expSlideTick('"+b+"');",a.Interval)}function expSlideTick(d){var a=anim[d],c=(new Date).getTime()-a.StartTime;if(c>a.Duration)expEndSlide(d);else{var b=Math.round(c/a.Duration*a.MaxHeight);if("close"==a.Action)b=a.MaxHeight-b;a.Object.style.height=b+"px"}}function expEndSlide(b){var a=anim[b];clearInterval(a.TimerID);if("close"==a.Action){if(0==a.MinHeight)a.Object.style.display="none";a.Object.style.height=a.MinHeight+"px"}else a.Object.style.height=a.MaxHeight+"px";a.DoneFn&&a.DoneFn();delete anim[b]}ExpPostbackObj=function(){this.reset()};ExpPostbackObj.prototype={reset:function(){this.pb=[];this._posting=false;this._pendingChangeCount=0;this._postRequestCount=0;this._isProcessingResults=false},isBusy:function(){return this._posting},isProcessingResults:function(){return this._isProcessingResults},queueChange:function(c,b,a){this.pb.push({type:"change",id:c,value:b});++this._pendingChangeCount;this.postWorker(a)},queueChanges:function(b,d,c){for(var a=0,e=b.length;a<e;++a){this.pb.push({type:"change",id:b[a],value:d[a]});++this._pendingChangeCount}this.postWorker(c)},selectModel:function(a,b){this.pb.length>0&&this.pb.push({type:"postMarker"});this.pb.push({type:"model",series:!a?"":a,model:!b?"":b});this.post()},updateConfig:function(b,a,c){this.pb.length>0&&this.pb.push({type:"postMarker"});this.pb.push({type:"updateConfig",updateType:b,targetType:a,id:c});this.post()},action:function(b,c,a,d){if(this.pb.length>0||this._posting)return;this.pb.push({type:"action",action:b,value:c,verb:d||"POST"});this.post(a)},raw:function(b,a){this.pb.length>0&&this.pb.push({type:"postMarker"});this.pb.push({type:"raw",data:b});this.post(a)},post:function(a){this.pb.push({type:"postMarker"});this._postRequestCount++;this.postWorker(a)},updateStatus:function(){var a=this._pendingChangeCount>0?PROCESSING_CAP_PEND.formatEx({NUMPENDING:this._pendingChangeCount}):PROCESSING_CAP;expUpdateSB(a,true)},postWorker:function(f){if(this._posting){this.updateStatus();return}if(this._postRequestCount>0)this._postRequestCount--;else if(this._pendingChangeCount<=0){f&&f();return}var d=$elem(EXP_TOOLBAR+"Mask");this._posting=true;try{if(d)d.style.display="block";var b="",h=false,g=true,i="POST";while(this.pb.length>0){var a=this.pb.shift();if("postMarker"==a.type&&b.length>0)break;else if("change"==a.type){h=true;this._pendingChangeCount--;b+='<change id="'+(a.id||"")+'"'+(a.value==null?' isnull="true"':"")+">"+expCleanForPostback(a.value)+"</change>"}else if("action"==a.type){var k=a.value?' value="'+a.value+'"':"";b+="<action"+k+">"+a.action+"</action>";i=a.verb;g="KEEPALIVE"!=a.action}else if("model"==a.type)b="<selectModel><series>"+a.series+"</series><model>"+a.model+"</model></selectModel>";else if("updateConfig"==a.type)b='<updateConfig type="'+a.updateType+'" targetType="'+a.targetType+'" id="'+a.id+'" />';else if("raw"==a.type)b=a.data}if(b.length>0){b=h?'<postBack xmlns="urn:webconfigurator-schema"><changes>'+b+"</changes></postBack>":'<postBack xmlns="urn:webconfigurator-schema">'+b+"</postBack>";var e=this,l=function(){if(d)d.style.display="none";e._posting=false;e._isProcessingResults=false;e.postWorker(f)},j=false,c=getAvailRequestObject();if(c.req){c.req.onreadystatechange=function(){if(4==c.req.readyState){e._isProcessingResults=true;var a=c.req.responseXML;if(null!=a&&""!=a.xml&&null!=a.xml)expParseActionResult(a);else expPostActionSubmit(c.req.responseText);c.done();l()}};var m=EXP_CONFIGDIR+"/handlers/ClientUpdate.ashx";c.req.open(i,m,!j);c.req.send(b);g&&this.updateStatus()}}else this._posting=false}catch(n){c&&c.done();alert("An error occurred while updating the configuration.\n\n"+n.message);expUpdateSB("An error occuring during postback.",true);this.reset();if(d)d.style.display="none"}}};ExpPropGridMgrObj=function(){this.reset();this.Offset_Name=0;this.Offset_Template=1;this.Offset_ClientInitCtlIds=2;this.Offset_PropIds=3};ExpPropGridMgrObj.prototype={comboBoxIds:[],isGridLoaded:function(b){var a=$elem("G"+b);return null!=a&&a.tagName!="DIV"},initOption:function(e,b){var c=this.getCategoryLayoutType(e),a=this.getGridTemplate(e,b,"Flow"==c);if(!a)return;if("Flow"==c){var d=$elem("G"+b);if(null!=d){ReplaceOuterHTML(d,a.html);this.loadClientInitControls(a.clientInitControls,b)}}else this.loadClientInitControls(a.clientInitControls,b)},loadGrid:function(a){var c=$elem("G"+a);if(null!=c){var d=$elem(a),e=d.getAttribute("catId"),b=this.getGridTemplate(e,a,false);if(!b)return;ReplaceOuterHTML(c,b.html);this.loadClientInitControls(b.clientInitControls,a)}},loadCatGrid:function(b,a){var f=this,c=$elem(a);if(!hasAttrib(c,"selected")){c.setAttribute("selected","");var e=function(c,b){if(hasAttrib(c,"skip")||!b)return;b.innerHTML=f.fixUpId(c.innerHTML,a);b.removeAttribute("noSel");b.className=b.className};this.enumOptionCells(b,a,e)}var d=this.getClientInitControlIds(b);this.loadClientInitControls(d,a);this.setOptionLockedState(b,a)},loadClientInitControls:function(a,c){if(null==a)return;for(var b=0;b<a.length;b++){var d=a[b].substr(1,1);switch(d){case"D":this.createCalendar("cal"+a[b]+c);break;case"C":this.createComboBox("cbo"+a[b]+c);this.comboBoxIds.push(a[b]+c)}}},clearClientInitControls:function(b,e){if(null==b)return;for(var c=0,f=b.length,a,d;c<f;++c){a=b[c]+e;d=window[a];if(d){window[a].unwire();window[a]=null}}},killCatGrid:function(b,a){var c=$elem(a);if(!hasAttrib(c,"selected"))return;c.removeAttribute("selected");var d=this.getClientInitControlIds(b);this.clearClientInitControls(d,a);var e=function(a){a.innerHTML="";a.setAttribute("noSel","");a.removeAttribute("hide");a.removeAttribute("err");a.className=a.className};this.enumOptionCells(b,a,function(b,a){if(hasAttrib(b,"skip")||!a)return;e(a)})},enumOptions:function(l,h){var b,e,a,f,c=$elem("G"+l);if(c){var d,i=c.getAttribute("orientation");if("horizontal"==i)for(b=0,e=c.rows.length;b<e;++b){a=c.rows[b];if(a.parentNode.tagName=="THEAD")continue;d={id:a.id,selected:hasAttrib(a,"selected")};h(d)}else if("vertical"==i)for(b=0,e=c.rows.length;b<e;++b){a=c.rows[b];if(a.parentNode.tagName=="THEAD"||!hasAttrib(a,"hasInnerContent"))continue;var k=a.children[0].children[0],j=k.children[0];for(f=0;f<j.children.length;++f){var g=j.children[f];if(hasAttrib(g,"id")){d={id:g.id,selected:hasAttrib(g,"selected")};h(d)}}}}},enumOptionCells:function(j,f,d){var a,c,h,b=$elem(f);if("TR"==b.tagName){var e=$elem("G"+j+"_template");for(a=0;a<e.childNodes.length;++a){c=e.childNodes[a];d(c,b.childNodes[a])}}else if("COL"==b.tagName){var g=b.parentNode.parentNode,k=$elem("col"+f);for(a=1,h=g.rows.length;a<h;++a){var i=g.rows[a];c=i.children[0];d(c,i.children[k.cellIndex+1])}}},setOptionLockedState:function(b,c){var a=$elem("c"+b).getAttribute("locked");("cat"==a||"prop"==a)&&this.setLocked(b,c,true)},getGridTemplate:function(d,b,f){var c=f?"V:"+b:d;if(null!=EXP_GT)for(var a=0;a<EXP_GT.length;a+=4)if(c==EXP_GT[a+this.Offset_Name]){this.updateCache(d,b);var e=this.fixUpId(EXP_GT[a+this.Offset_Template],b);return{html:e,clientInitControls:EXP_GT[a+this.Offset_ClientInitCtlIds]}}alert("Unable to load grid template: "+c);return null},getCategoryLayoutType:function(a){return $elem("c"+a).getAttribute("layout")},getClientInitControlIds:function(c){if(null==EXP_GT)return null;for(var b=c,a=0;a<EXP_GT.length;a+=4)if(b==EXP_GT[a])return EXP_GT[a+this.Offset_ClientInitCtlIds];return null},getPropIds:function(c){if(null==EXP_GT)return null;for(var b=c,a=0;a<EXP_GT.length;a+=4)if(b==EXP_GT[a])return EXP_GT[a+this.Offset_PropIds];return null},fixUpId:function(b,a){return b.replace(/:[$]:/g,function(b){return":$:"==b?a:""})},createCalendar:function(a){$elem(a)&&createCalendar({hostId:a,replaceHost:true,onchange:expCalendarChanged})},createComboBox:function(a){$elem(a)&&createComboBox({hostId:a,replaceHost:true,onchange:expComboBoxChanged})},cacheTemplates:function(c){var a=this.allocCache(c),e,l,d,b,f=[],j=this.templates;if("Flow"==a.layout)for(e=0,l=a.options.length;e<l;++e){b=a.options[e];var k="G"+b;d=$elem(k);if(d){!d.outerHTML&&InitializeOuterHTML();j.push({catId:c,optId:b,layout:a.layout,gridId:k,html:d.outerHTML});f.push(b)}}else{var g=this.getClientInitControlIds(c);if(g){var i=[],h=[];this.enumOptions(c,function(k){if(!k.selected)return;for(var e=0;e<g.length;++e){var d=g[e]+k.id,l=$elem(d);if(l){window[d].unwire();i.push(d);h.push(l.innerHTML)}}j.push({catId:c,optId:b,layout:a.layout,controlIds:i,controlHtml:h});f.push(b)})}}a.options=f},restoreAllTemplates:function(){for(var h=function(a){window[a].rewire()},g=function(a){window[a]=null},f=0;f<this.templates.length;++f){var a=this.templates[f],d,c;if("Flow"==a.layout){var j=$elem(a.gridId);c=this.getClientInitControlIds(a.catId);if(j){ReplaceOuterHTML(j,a.html);d=h}else d=g;if(c)for(var b=0,i=c.length;b<i;++b){var l=c[b]+a.optId;d(l)}}else if("Grid"==a.layout)for(var b=0,i=a.controlIds.length;b<i;++b){var e=a.controlIds[b],k=$elem(e);if(k){k.innerHTML=a.controlHtml[b];h(e)}else g(e)}}this.templates=[]},updateCache:function(b,c){var a=this.allocCache(b);a.options.push(c)},allocCache:function(b){var a=parseInt(b,36)-1;if(this.cache.length<a||!this.cache[a])this.cache[a]={catId:b,layout:this.getCategoryLayoutType(b),options:[]};return this.cache[a]},reset:function(){this.cache=[];this.templates=[];this.comboBoxIds=[]},setLocked:function(e,f,h){var g=h?ExpLock:ExpUnLock,a=this.getPropIds(e);if(null==a||0==a.length)return;if(!f){var b=parseInt(e,36)-1;if(this.cache.length<b||!this.cache[b])return;for(var d=this.cache[b].options,c=0,i=d.length;c<i;++c)this.setLockedImpl(d[c],a,g)}else this.setLockedImpl(f,a,g)},setLockedImpl:function(d,e,f){for(var c=0,a;a=e[c];++c){var g=a+d,b=ExpGetActualControlRef(g);if(!b)continue;f(b)}}};ExpStringBuilder=function(){this.buf=[];this.delim=""};ExpStringBuilder.prototype={toString:function(){return this.buf.join(this.delim)},append:function(a){if(a)this.buf[this.buf.length]=a;return this}};var ExpUtil={getQueryStringValue:function(g,f,e){var c=e||"",a=this.splitQueryString(g);if(a)for(var b=0;b<a.length;++b){var d=a[b].split("=");if(d[0]==f){c=d[1];break}}return c},hasQueryStringKey:function(f,e){var c=false,a=this.splitQueryString(f);if(a)for(var b=0;b<a.length;++b){var d=a[b].split("=");if(d[0]==e){c=true;break}}return c},splitQueryString:function(c){var b=null,a=unescape(c||location.search);if(a.length>0){if(a[0]=="?")a=a.substr(1);b=a.split("&")}return b}};function HttpSync(){this.inUse=false;this.req=this.getRequestObject()}HttpSync.prototype={start:function(){this.inUse=true},done:function(){this.inUse=false},getRequestObject:function(){return window.XMLHttpRequest?new XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null}};function ExpHashtable(){this.clear()}ExpHashtable.prototype={clear:function(){this.hashtable={}},add:function(b,a){if(null==b||null==a)throw"Invalid hashtable entry: {"+b+","+a+"}";this.hashtable[b]=a},remove:function(a){if(null==a)throw"Unable to remove entry from hashtable.  Invalid key.";this.hashtable[a]=null},getCount:function(){var a=0;for(var b in this.hashtable)if(null!=this.hashtable[b])++a;return a},getKeys:function(){var a=[];for(var b in this.hashtable)null!=this.hashtable[b]&&a.push(b);return a},getValues:function(){var a=[];for(var c in this.hashtable){var b=this.hashtable[c];null!=b&&a.push(b)}return a}};String.prototype.format=function(){var b=/{(\d+)}/g,a=arguments,c=function(c,b){return a[parseInt(b)]};return this.replace(b,c)};String.prototype.formatEx=function(a){var b=/{(\w+)}/g,c=function(c,b){return a[b]};return this.replace(b,c)};String.prototype.startsWith=function(a){return!a||0==a.length||this.length<a.length?false:this.substr(0,a.length)==a};var EXP_PB=new ExpPostbackObj,EXP_PG=new ExpPropGridMgrObj;function InitializeOuterHTML(){var a=null;if(document.body.__defineGetter__)if(HTMLElement){a=HTMLElement.prototype;a.__defineGetter__&&a.__defineGetter__("outerHTML",function(){var a=this.parentNode,b=document.createElement(a.tagName);b.appendChild(this);var c=b.innerHTML;a.appendChild(this);return c})}a&&a.__defineSetter__&&a.__defineSetter__("outerHTML",function(d){var b=document.createElement("div");b.innerHTML=d;var a=document.createRange();a.selectNodeContents(b);var c=a.extractContents();this.parentNode.insertBefore(c,this);this.parentNode.removeChild(this)})}function ReplaceOuterHTML(a,b){!a.outerHTML&&InitializeOuterHTML();a.outerHTML=b};