function $elem(a){return document.getElementById(a)}var DROPDOWN_ID="cboBox",DROPDOWNITEMS_ID="cboItems",DROPDOWN_MINWIDTH=20,DROPDOWN_IMAGEWIDTH=16,DROPDOWN_DEFAULT_MAXCOLWIDTH=150,DROPDOWN_DEFAULT_MINCOLWIDTH=50;function ExpSetInnerValue(a,b){if(a.textContent!=null)a.textContent=b;else a.innerText=b}function createComboBox(a){return new ComboBox(a)}function ComboBoxList(e,b,a){this.comboBox=e;this.clear();this.headers=null;if(null!=b){var c;try{c="string"==typeof b?eval(b):b}catch(g){return}for(var d=0;d<c.length;d++)this.add(c[d])}if(null!=a&&e.showHeaders!="Never"){var f;try{f="string"==typeof a?eval(a):a}catch(g){return}this.headers=f}}ComboBoxList.prototype={getCount:function(){return this.items.length},add:function(a){if("string"==typeof a)this.items.push([a]);else if(a.constructor==Array)this.items.push(a);else{var b=new Error;b.name="Invalid Data Type";b.message="Invalid combobox item type: expected string or array";throw b;}},getItem:function(a){return this.items[a]},getSelectedItemText:function(a){try{return this.selectedItemIndex>-1?this.items[this.selectedItemIndex][a]:null}catch(b){return null}},getValueByDisplayText:function(c,b){if(null!=this.items)for(var a=0;a<this.items.length;a++)if(this.items[a][b]==c)return this.items[a][0];return""},setList:function(a){this.clear();if(null!=a)this.items=a},loadFromStringArray:function(a){this.clear();if(null!=a)for(var b=0;b<a.length;b++)this.add(a[b])},createColumnsIn:function(d,a){if(1==this.columnCount){if(a.keyColor)d.style.backgroundColor=a.keyColor}else if(this.columnCount>1){var c=$c("div",d);c.style.width=a.key+"px";if(a.keyColor)c.style.backgroundColor=a.keyColor;c.className="xComboCol";if(a.key==0)c.style.border="none";for(var j=a.key+3,i=a.detail,f=i,g=f+3,e=1;e<this.columnCount-1;++e){var h=j+(e-1)*g,b=$c("div",d);b.style.left=h+"px";b.style.width=f+"px";if(a.detailColor)b.style.backgroundColor=a.detailColor;b.className="xComboCol"}}},createHeadersIn:function(f,d){var i=d.key+"px",h=d.detail+"px",e=getIEVersion(),g=e>7,c=$c("div",f);c.className="xComboItem";c.setAttribute("header","");if(null==this.headers||0==this.headers.length)return;for(var a=0;a<Math.min(this.columnCount,this.headers.length);a++){var b=$c("div",c);if(a==0){b.style.width=i;if(e==7)b.style.styleFloat="left"}else if(g||a<this.columnCount-1)b.style.width=h;ExpSetInnerValue(b,b.title=this.headers[a])}},createItemsIn:function(d,h,n,l,m){var a;if(0==this.getCount()){a=$c("div",d);a.className="xComboItem";a.setAttribute("empty","");a.innerHTML=a.title=CTL_CBO_NOITEMS;return}for(var k=h.key+"px",p=h.detail+"px",j=getIEVersion(),i=j>7,f=0;f<this.items.length;++f){var e=this.getItem(f);a=$c("div",d);a.id="cboItem"+f.toString();a.className="xComboItem";a.value=e[0];var g=Math.min(this.columnCount,e.length);if(1==g){var b=$c("div",a);if(i)b.style.width=k;ExpSetInnerValue(b,b.title=e[0]||"")}else for(var c=0;c<g;c++){var b=$c("div",a);if(c==0){b.style.width=k;if(j==7)b.style.styleFloat="left"}else if(i||c<g-1)b.style.width=p;ExpSetInnerValue(b,b.title=e[c]||"")}mouseEvents(a,n,l,m)}if(-1==this.selectedItemIndex){var o=this.comboBox.getValue();this.setSelectedItem(o)}if(-1!=this.selectedItemIndex){a=d.children[this.selectedItemIndex];a.setAttribute("selected","");a.setAttribute("focused","")}else if(-1!=this.focusedItemIndex){a=d.children[this.focusedItemIndex];a.setAttribute("focused","")}},acceptFocusedItem:function(){this.selectedItemIndex=this.focusedItemIndex},selectFirstItem:function(a){this.setFocusedState(a,false);if(this.getCount()>0){this.focusedItemIndex=0;this.setFocusedState(a,true)}},selectLastItem:function(a){var b=this.getCount();this.setFocusedState(a,false);if(b>0){this.focusedItemIndex=b-1;this.setFocusedState(a,true)}},selectPrevItem:function(b,a){if(this.focusedItemIndex<=0)return;if(!a)a=1;this.setFocusedState(b,false);if(this.focusedItemIndex>0&&this.getCount()>0){this.focusedItemIndex-=a;if(this.focusedItemIndex<0)this.focusedItemIndex=0;this.setFocusedState(b,true)}},selectNextItem:function(c,b){var a=this.getCount();if(this.focusedItemIndex>=a-1)return;if(!b)b=1;this.setFocusedState(c,false);if(this.focusedItemIndex<a){this.focusedItemIndex+=b;if(this.focusedItemIndex>=a)this.focusedItemIndex=a-1;this.setFocusedState(c,true)}},selectItemByIndex:function(b,a){var c=this.getCount();if(a<0||a>=c)return;this.setFocusedState(b,false);this.focusedItemIndex=a;this.setFocusedState(b,true)},selectCurrentItem:function(a){this.setFocusedState(a,false);this.focusedItemIndex=this.selectedItemIndex;this.setFocusedState(a,true)},setFocusedState:function(b,c){if(b.className!="xComboItems")return;var a=b.children[this.focusedItemIndex];if(!a)return;if(c)a.setAttribute("focused","");else a.removeAttribute("focused");a.className=a.className},clear:function(){this.items=[];this.selectedItemIndex=-1;this.focusedItemIndex=-1;this.inputItemIndex=-1;this.headers=null},setSelectedItem:function(b){this.focusedItemIndex=-1;this.selectedItemIndex=-1;for(var a=0;a<this.items.length;++a)if(this.items[a][0]==b){this.selectedItemIndex=a;this.focusedItemIndex=a;this.inputItemIndex=a;break}if(-1==this.focusedItemIndex)this.focusedItemIndex=0},setNoSelectedItem:function(){this.focusedItemIndex=-1;this.selectedItemIndex=-1;this.inputItemIndex=-1},findNext:function(c,a){var b=this.focusedItemIndex;return this.findNextByIndex(c,a,b)},findNextByInputText:function(c,a){var b=this.inputItemIndex;return this.findNextByIndex(c,a,b)},findNextByIndex:function(a,c,e){var d=this.getCount();if(0==d)return;a=a.toLowerCase();var b=this.getNextMatch(a,c,e+1,d);if(-1==b)b=this.getNextMatch(a,c,0,e);return b},getNextMatch:function(e,b,c,d){for(var a=c;a<d;++a){var f=this.getItem(a)[b]||" ";if(e==f.substr(0,1).toLowerCase())return a}return-1}};function ComboBox(g){var a=$elem(g.hostId);if(!a){alert("Unable to render combobox; '"+g.hostId+"' cannot be found.");return}var i=a.getAttribute("comboId");if(!i){alert("Unable to render combobox; the 'comboId' property has not been set on '"+this.hostId+"'.");return}var h=a.getAttribute("cboBlankValue")||"";if(h.length>11&&h.substring(0,11)=="javascript:")h=eval(h);this.PREFIX="combo";this.id=i;this.dropState=0;this.itemsToDisplay=a.getAttribute("cboItemsToDisplay")||15;this.trackBackColor=a.getAttribute("cboTrackBackColor")||"#bddbff";this.trackForeColor=a.getAttribute("cboTrackForeColor")||"#4a5dd6";this.readOnly="false"==a.getAttribute("cboReadOnly")?false:true;this.allowUserBlank="true"==a.getAttribute("cboAllowUserBlank")?true:false;this.blankValue=h;this.isBlank=true;this.showHeaders=a.getAttribute("cboShowHeaders")||"Auto";this.showValue=a.getAttribute("cboShowValue")||"true";this.setList(g.list||a.getAttribute("cboList")||null,g.headers||a.getAttribute("cboHeaders")||null);this.dropDownWidth=a.getAttribute("cboDropDownWidth")||"auto";this.keyColWidth=a.getAttribute("cboKeyColWidth")||"auto";this.keyColColor=a.getAttribute("cboKeyColColor")||null;this.detailColColor=a.getAttribute("cboDetailColColor")||null;this.displayColumn=a.getAttribute("cboDisplayColumn")||1;this.required="true"==a.getAttribute("cboValueReq")?true:false;this.locked="true"==a.getAttribute("cboLocked")?true:false;if(hasAttrib(a,"cboChangeConfirmPrompt"))this.changeConfirmPrompt=a.getAttribute("cboChangeConfirmPrompt")||":CTL_CHANGEPROMPT";this.displayMode=a.getAttribute("cboDisplayMode")||"Dropdown";this.autoMatchBehavior=a.getAttribute("cboAutoMatchBehavior")||"AutoSelect";var b=$c("div");if(g.replaceHost){a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a)}else a.appendChild(b);b.className="xComboBox";if(hasAttrib(a,"cboPositionStyle"))b.style.position=a.getAttribute("cboPositionStyle");if(hasAttrib(a,"cboForeColor"))b.style.color=a.getAttribute("cboForeColor");var q=a.getAttribute("cboForceId")||false;b.id=q?i:this.PREFIX+i;var k=a.getAttribute("cboWidth"),d=convToPixelUnits(k)||null;if(d){if(parseInt(d)<DROPDOWN_MINWIDTH)d=DROPDOWN_MINWIDTH+"px";b.style.width=d}else if(k&&k.substr(k.length-1,1)=="%"){var n=b.parentNode;if(n){var m=n.offsetWidth;d=(m<DROPDOWN_MINWIDTH?DROPDOWN_MINWIDTH:m)+"px";b.style.width=d;b.setAttribute("sizeToParent","")}}var o="true"==a.getAttribute("cboRightJustify")?true:false;if(o){b.style.right="0";b.style.float="Right";b.style.marginRight="2px"}b.style.textAlign=a.getAttribute("cboAlignment")||"left";var j=a.getAttribute("cboBorderColor")||-1,p="true"==a.getAttribute("cboBorderless")?true:false;p&&b.setAttribute("borderless","");var e=$c("div");if(j!=-1)e.style.borderColor=j;e.control=this;e.className="xComboEdit";if(d)e.style.width=parseInt(d)-DROPDOWN_IMAGEWIDTH+"px";var c=this.readOnly?$c("div"):$c("input");e.appendChild(c);c.className="xEdit";c.tabIndex=0;c.control=this;mouseEvents(c,this.mouseOver,this.mouseOut,c.tagName=="DIV"?EXP_AUTODISPLAYLIST?this.toggle:this.focus:null);c.onmousedown=this.close;c.onkeydown=this.inputKeyDown;if(c.tagName=="DIV"){c.onkeypress=this.inputKeyPress;c.onblur=this.validateValue}else{c.onblur=this.inputValidateValue;if(d)c.style.width=parseInt(d)-DROPDOWN_IMAGEWIDTH-4+"px"}if(this.showValue=="false")c.style.visibility="hidden";var l=parseInt(a.cboDropDownGap)||1;if(l<1)e.style.right="13px";else if(l>1)e.style.right=(15+l).toString()+"px";var f=$c("div");f.className="xImage";f.setAttribute("displayMode",this.displayMode);if(j!=-1)f.style.borderColor=j;mouseEvents(f,this.mouseOver,this.mouseOut,this.toggle);f.tabIndex=-1;f.control=this;window[i]=this;this.comboBoxControl=b;this.inputControl=c;this.imageControl=f;b.appendChild(e);b.appendChild(f);this.setValue(a.getAttribute("cboValue")||null);this.onchange=g.onchange;if(c.tagName=="INPUT")this.onkeypress=g.onkeypress;this.topIndex=-1}ComboBox.prototype={blur:function(){try{var a=this.control||this;a.inputControl&&a.inputControl.blur()}catch(b){}},focus:function(){try{var a=this.control||this;if(a.inputControl){a.inputControl.blur();a.inputControl.focus()}}catch(b){}},select:function(){this.inputControl&&this.inputControl.tagName=="INPUT"&&this.inputControl.select()},deselect:function(){if(this.inputControl&&this.inputControl.tagName=="INPUT")this.inputControl.value=this.inputControl.value},setList:function(b,a){this.list=new ComboBoxList(this,b,a);this.showColHeaders=null!=this.list.headers},setValue:function(a){if(!a)a="";this.inputControl&&this.setValueImpl(a)},userSetValue:function(b){var a=this.list.getValueByDisplayText(b,this.displayColumn-1);this.userSetValueImpl(b,!a||""==a?false:true,a)},userSetValueImpl:function(a,c,d){if(!a)a="";if(a==""&&this.isBlank&&this.list.inputItemIndex==this.list.selectedItemIndex)return;if(this.inputControl&&a!=this.value){var f=this.isBlank?"<BLANK>":this.value,e=a||"<BLANK>";if(!this.isBlank){var b=this.changeConfirmPrompt;if(b&&b.length>0){if(b.substr(0,1)==":")b=window[b.substr(1)];var g=b.formatEx({OLDVALUE:f,NEWVALUE:e});if(!confirm(g))return}}this.setValueImpl(c?d:a)}},setValueImpl:function(b){if(this.oldValue!=b||this.list.inputItemIndex!=this.list.selectedItemIndex){var a=this.inputControl;this.oldValue=b;if(this.readOnly&&""==b){this.isBlank=true;this.list.setNoSelectedItem();if(a.tagName=="INPUT")a.value=this.blankValue;else{ExpSetInnerValue(a,this.blankValue);this.comboBoxControl.setAttribute("value",this.blankValue)}a.setAttribute("blank","");a.className=a.className;this.value=this.blankValue}else{this.isBlank=false;this.list.setSelectedItem(b);if(a.tagName=="INPUT")a.value=b;else{this.comboBoxControl.setAttribute("value",b);var c=this.list.getSelectedItemText(this.displayColumn-1);if(null==c)c=b;ExpSetInnerValue(a,c)}a.removeAttribute("blank");a.removeAttribute("browsing");a.className=a.className;this.value=b}if(this.onchange)this.onchange(this,b)}},getValue:function(){return this.isBlank?"":this.value},sizeToParent:function(){if(!hasAttrib(this.comboBoxControl,"sizeToParent"))return;var c=this.comboBoxControl.parentNode;if(c)for(var e=c.childNodes,d=0;d<e.length;++d){var a=e[d];if(a.tagName=="DIV"&&a.className=="xComboBox"){var b=c.offsetWidth;if(b<DROPDOWN_MINWIDTH)b=DROPDOWN_MINWIDTH;a.style.width=b+"px";a.childNodes[0].style.width=b-DROPDOWN_IMAGEWIDTH+"px"}}},mouseOver:function(){var a=this.className=="xImage"?this:this.tagName=="INPUT"||this.tagName=="DIV"?this.control.imageControl:null;if(!a)return;a.setAttribute("hot","");a.className=a.className},mouseOut:function(){var a=this.className=="xImage"?this:this.tagName=="INPUT"||this.tagName=="DIV"?this.control.imageControl:null;if(!a)return;a.removeAttribute("hot");a.className=a.className},inputKeyPress:function(b){if(window.event)b=window.event;switch(b.keyCode){case 9:case 27:return null;case 40:case 13:case 38:case 34:case 33:case 36:case 35:case 8:return false}var a=this.control||this;if(a.displayMode=="Picker")a.openImpl();else{var c=b.which?String.fromCharCode(b.which):String.fromCharCode(b.keyCode);switch(a.autoMatchBehavior){case"AutoSelect":a.performAutoSelectActions(c,a);break;case"DisplayList":a.performDisplayListActions(c,a);break;default:a.performBrowseActions(c,a)}}b.returnValue=false},performAutoSelectActions:function(d,a){var c=0==a.getKeyColWidth()?1:0,b=a.list.findNext(d,c);if(b<0)return;b>=0&&a.userSetValue(a.list.items[b][c])},performBrowseActions:function(f,a){var e=0==a.getKeyColWidth()?1:0,c=a.list.findNextByInputText(f,e);if(c<0)return;var d=a.list.items[c][e];if(d){ExpSetInnerValue(a.inputControl,d);var b=this.inputControl;b.removeAttribute("blank");b.setAttribute("browsing","");b.className=b.className;a.list.inputItemIndex=c}},performDisplayListActions:function(c,a){if(a.openImpl())if(a.displayMode!="Picker"){a.isDropping=false;var b=$elem(DROPDOWNITEMS_ID);a.findValueByChar(c,b)}},inputKeyDown:function(b){var a=this.control||this;if(window.event)b=window.event;switch(b.keyCode){case 8:case 46:if(a.readOnly){a.allowUserBlank&&a.userSetValue("");b.returnValue=false}break;case 9:if($elem(DROPDOWN_ID)){a.close();a.select()}break;case 13:if(a.list.inputItemIndex!=a.list.selectedItemIndex){var e=0==a.getKeyColWidth()?1:0,d=a.list.inputItemIndex;a.userSetValue(a.list.items[d][e])}else if(!a.readOnly){a.close();a.select();a.inputValidateValue();b.returnValue=false}var c=a.inputControl;if(c.hasAttribute("browsing")){c.removeAttribute("browsing");c.className=c.className}break;case 27:if(0==a.dropState)if(a.list.inputItemIndex!=a.list.selectedItemIndex){var c=a.inputControl;c.removeAttribute("browsing");a.isBlank&&a.userSetValue("");c.className=c.className;var e=0==a.getKeyColWidth()?1:0,d=a.list.selectedItemIndex;if(d>-1){var f=a.list.items[d][e];ExpSetInnerValue(a.inputControl,f);a.list.inputItemIndex=a.list.selectedItemIndex}b.returnValue=false}else return;else{a.close();a.select();b.returnValue=false}break;case 32:case 40:case 115:if(a.openImpl()){a.isDropping=false;b.preventDefault?b.preventDefault():(b.returnValue=false)}}if(a.onkeypress)a.onkeypress(a,b.keyCode)},dropdownKeyPress:function(b){if(window.event)b=window.event;var a=$elem(DROPDOWNITEMS_ID);if(!a)return;var c=a.control;if(!c)return;var d=String.fromCharCode(b.keyCode);c.findValueByChar(d,a);b.returnValue=false},dropdownKeyDown:function(b){if(window.event)b=window.event;var c=$elem(DROPDOWNITEMS_ID);if(!c)return;var a=c.control;if(!a)return;switch(b.keyCode){case 27:case 9:a.close();a.select();if(9!=b.keyCode)b.returnValue=false;break;case 13:case 32:a.list.acceptFocusedItem();a.userSetValue(a.list.getSelectedItemText(0));a.close();a.select();b.returnValue=false;break;case 35:a.list.selectLastItem(c);a.scrollToSelection();b.returnValue=false;break;case 36:a.list.selectFirstItem(c);a.scrollToSelection();b.returnValue=false;break;case 33:a.list.selectPrevItem(c,a.itemsToDisplay-1);a.scrollToSelection();b.returnValue=false;break;case 34:a.list.selectNextItem(c,a.itemsToDisplay-1);a.scrollToSelection();b.returnValue=false;break;case 38:if(b.altKey){a.close();a.select()}else{a.list.selectPrevItem(c);a.scrollToSelection()}b.returnValue=false;break;case 40:a.list.selectNextItem(c);a.scrollToSelection();b.returnValue=false;break;case 8:b.returnValue=false}},validateValue:function(){var a=this.control||this;if(a.list.inputItemIndex!=a.list.selectedItemIndex){var c=0==a.getKeyColWidth()?1:0,d=a.list.inputItemIndex;a.userSetValue(a.list.items[d][c])}else a.setValueImpl(a.getValue());var b=a.inputControl;if(b.hasAttribute("browsing")){b.removeAttribute("browsing");b.className=b.className}},inputValidateValue:function(){var a=this.control||this;a.setValueImpl(a.inputControl.value)},findValueByChar:function(d,c){var b=0==this.getKeyColWidth()?1:0,a=this.list.findNext(d,b);if(a>=0){this.list.selectItemByIndex(c,a);this.scrollToSelection()}},toggle:function(){var a=this.control||null;if(!a)return;var b=$elem(DROPDOWN_ID);if(!b)a.openImpl();else a.close()},open:function(){var a=this.className!="xImage"?this.imageControl:this;if(!a)return;var b=a.control;b.openImpl()},openImpl:function(){if(this.locked)return false;if(1==this.dropState)return true;if("Picker"==this.displayMode){expListPicker(this);return true}var a=this.createDropdown();this.dropControl=a;document.body.appendChild(a);this.dropState=1;this.isDropping=true;this.comboBoxControl.style.zIndex=99999;attachTo(window.document,"click",this.close);attachTo(window.document,"mousedown",this.evalEventToClose);attachTo(window.document,getBrowser()=="Firefox"?"DOMMouseScroll":"mousewheel",this.evalEventToClose);this.deselect();this.list.selectCurrentItem(a.children.cboItems);this.scrollToSelection();window.setTimeout(this.afterOpen,1);return true},afterOpen:function(){var a=$elem(DROPDOWNITEMS_ID);a.focus();attachTo(window.document,"keypress",a.control.dropdownKeyPress);attachTo(window.document,"keydown",a.control.dropdownKeyDown)},getMouseCoords:function(a){var b=0,c=0;if(a.pageX||a.pageY){b=a.pageX;c=a.pageY}else if(a.clientX||a.clientY){b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;c=a.clientY+document.body.scrollTop+document.documentElement.scrollTop}return{x:b,y:c}},evalEventToClose:function(d){var a=$elem(DROPDOWN_ID),b=d||window.event,c=b.pageX||b.pageY?{x:b.pageX,y:b.pageY}:{x:b.clientX,y:b.clientY},e=c.x>=a.offsetLeft&&c.x<=a.offsetLeft+a.offsetWidth&&(c.y>=a.offsetTop&&c.y<=a.offsetTop+a.offsetHeight);if(!e){var f=d.type=="mousewheel";a.parentControl.close(f)}},close:function(c){var b=$elem(DROPDOWN_ID);if(!b)return;var a=b.parentControl;if(a.isDropping||0==a.dropState){a.isDropping=false;return}if(getIEVersion()==7||(c===undefined||c)){a.blur();a.focus()}a.closeImpl(b)},closeImpl:function(a){detachFrom(window.document,"click",this.close);detachFrom(window.document,"mousedown",this.evalEventToClose);detachFrom(window.document,getBrowser()=="Firefox"?"DOMMouseScroll":"mousewheel",this.evalEventToClose);detachFrom(window.document,"keypress",this.dropdownKeyPress);detachFrom(window.document,"keydown",this.dropdownKeyDown);document.body.removeChild(a);this.comboBoxControl.style.zIndex=0;this.dropControl=null;this.dropState=0},calcDropdownInfo:function(){var a=parseInt(this.comboBoxControl.offsetWidth)-2,b=a,c=a,f=0;if(this.list.getCount()>0){c="auto"==this.keyColWidth?Math.max(Math.min(a,DROPDOWN_DEFAULT_MAXCOLWIDTH),DROPDOWN_DEFAULT_MINCOLWIDTH):parseInt(this.keyColWidth);var e=c+(this.list.columnCount>1?DROPDOWN_DEFAULT_MINCOLWIDTH:0),d=Math.max(Math.min(a,DROPDOWN_DEFAULT_MAXCOLWIDTH),DROPDOWN_DEFAULT_MINCOLWIDTH)*this.list.columnCount;b="auto"==this.dropDownWidth?"auto"==this.keyColWidth?d:Math.max(e,d):Math.max(e,parseInt(this.dropDownWidth));if(b<a)b=a;f=this.list.columnCount>1?(b-c-2*this.list.columnCount)/(this.list.columnCount-1):0}return{overall:Math.floor(b),key:Math.floor(c),detail:Math.floor(f),keyColor:this.keyColColor,detailColor:this.detailColColor}},createDropdown:function(){var c=this.list.getCount();if(c>0){var i=this.list.items[0];this.list.columnCount="String"==typeof i?1:i.length}else this.list.columnCount=1;var f=this.calcDropdownInfo(),l=f.overall,a=$c("div");a.parentControl=this;a.id=DROPDOWN_ID;a.className="xCombo";a.tabIndex=-1;a.style.width=l+"px";var h=Math.min(Math.max(1,c),this.itemsToDisplay);if(c>0)h+=this.showColHeaders;a.style.height=h*15+"px";var p=function(a){var e=0,f=0,b=0,c=0;while(null!=a){e+=a.offsetLeft||0;f+=a.offsetTop||0;b+=a.scrollLeft||0;c+=a.scrollTop||0;var d=a.parentNode;if(a.offsetParent!=d){b+=d.scrollLeft||0;c+=d.scrollTop||0}a=a.offsetParent}return{horizOffset:e,vertOffset:f,horizScrollOffset:b,vertScrollOffset:c}},e=p(this.comboBoxControl),k=e.horizOffset-e.horizScrollOffset,m=e.vertOffset-e.vertScrollOffset+parseInt(this.comboBoxControl.offsetHeight)+1,j=l+2,g=parseInt(a.style.height)+2,o=getPageWidth(),n=getPageHeight(),q=k+j>o?o-j:k,r=m+g>n?n-g:m;a.style.left=q+"px";a.style.top=r+"px";if(c>0&&(this.list.columnCount>1||this.showColHeaders)){var d=$c("div",a);d.className="xComboCols";if(this.list.getCount()>this.itemsToDisplay&&!this.showColHeaders)d.style.overflowY="scroll";this.list.createColumnsIn(d,f);this.showColHeaders&&this.list.createHeadersIn(d,f)}var b=$c("div",a);b.id=DROPDOWNITEMS_ID;b.className="xComboItems";b.control=this;if(c>0){b.setAttribute("scrollable","");if(this.showColHeaders)b.style.top="15px"}this.list.createItemsIn(b,f,this.track,this.untrack,this.selectItem);return a},scrollToSelection:function(){setTimeout(this.scrollToSelectionImpl,0)},scrollToSelectionImpl:function(){var c=$elem(DROPDOWNITEMS_ID);if(!c)return;var a=c.parentNode.parentControl,b=-1!=a.list.focusedItemIndex?a.list.focusedItemIndex:a.list.selectedItemIndex;a.topIndex=-1==b||a.list.focusedItemIndex<b?0:b-(a.topIndex+a.itemsToDisplay)>=0?Math.max(b-a.itemsToDisplay+1,0):b<a.topIndex?b:a.topIndex;var d=$elem("cboItem"+a.topIndex.toString());if(d)c.scrollTop=d.offsetTop},track:function(){var a=$elem(DROPDOWN_ID).parentControl;this.style.backgroundColor=a.trackBackColor;this.style.color=a.trackForeColor},untrack:function(){this.style.backgroundColor="";this.style.color=""},selectItem:function(){var a=$elem(DROPDOWN_ID).parentControl;a.userSetValue(this.value)},getKeyColWidth:function(){return"auto"==this.keyColWidth?-1:parseInt(this.keyColWidth)},setLocked:function(a){this.locked=a;if(this.inputControl&&this.inputControl.tagName=="INPUT")if(a)this.inputControl.setAttribute("readOnly","");else this.inputControl.removeAttribute("readOnly")},unwire:function(){},rewire:function(){var b=$elem(this.PREFIX+this.id),a=b.children[0].children[0],c=b.children[1];a.control=this;mouseEvents(a,this.mouseOver,this.mouseOut,a.tagName=="DIV"?EXP_AUTODISPLAYLIST?this.toggle:this.focus:null);a.onmousedown=this.close;a.onkeydown=this.inputKeyDown;if(a.tagName=="DIV")a.onkeypress=this.inputKeyPress;a.onblur=a.tagName=="DIV"?this.validateValue:this.inputValidateValue;mouseEvents(c,this.mouseOver,this.mouseOut,this.toggle);c.control=this;var d=this.onchange;this.onchange=null;this.setValue(this.getValue());this.onchange=d;this.comboBoxControl=b;this.inputControl=a;this.imageControl=c}};function mouseEvents(a,c,d,b){a.onmouseover=c;a.onmouseout=d;if(b)a.onclick=b};